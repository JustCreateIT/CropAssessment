<?php

/**
 * Class Report
 * The report builder
 */class Report
{
  
	public $report_name;
	public $farm;
	public $paddock;
	public $crop;
	public $zones;
	public $samples;
	public $days_post_planting;
	public $sample_date;
	public $target_yield;
	public $target_tonnes_hectare;
	public $growth_stage_id;
	

    /**
     * Start the report creation, get the required data and build each section of the report
     */
    public function __construct($farm_id, $paddock_id, $crop_id, $growth_stage_id)
    {
     
        $this->growth_stage_id = $growth_stage_id;
		$this->initialise($farm_id, $paddock_id, $crop_id);
    }
    
    private function initialise($farm_id, $paddock_id, $crop_id){
		
		/*
		echo '<pre>';
		echo var_dump("farm_id=".$farm_id);
		echo var_dump("paddock_id=".$paddock_id);
		echo var_dump("crop_id=".$crop_id);
		echo '</pre>';
		*/
		
		$this->crop = new Crop($farm_id, $paddock_id, $crop_id);
		//$this->paddock = new Paddock($farm_id, $paddock_id);		
		$this->zones  = new Zones($crop_id);	
		$this->samples  = new Samples($this->growth_stage_id, $this->crop->crop_id);
	
		$this->report_name = ucwords(DatabaseCommon::getGrowthStageNameByID($this->growth_stage_id));
		$this->sample_date = $this->samples->samples[0]->sample_date;
		$this->days_post_planting = DatabaseCommon::calculateDaysPostPlanting($this->crop->crop_plant_date, $this->sample_date);
		//$this->target_paddock_yield = DatabaseCommon::getTargetPaddockYield($this->crop->crop_target_population, $this->crop->crop_plant_date);
		$this->target_yield = DatabaseCommon::getTargetYield($this->crop->crop_target_population, $this->crop->crop_plant_date);
		//$this->target_tonnes_hectare = DatabaseCommon::getTargetTonnesHectare($this->target_yield, $this->paddock->paddock_area);
		//$this->target_tonnes_hectare = DatabaseCommon::getTargetTonnesHectare($this->target_yield, $this->crop->paddock_area);
		$this->target_tonnes_hectare = DatabaseCommon::getTargetTonnesHectare($this->target_yield, $this->crop->crop_area);			
		
	}

	public static function array_get($array, $property, $default_value = null) {
        return isset($array[$property]) ? $array[$property] : $default_value;
    }   

    private function getRecordByName($sql){
        
        $database = DatabaseFactory::getFactory()->getConnection();
        $stmt = $database->prepare($sql);
        $stmt->execute(array(':test_id' => $this->record_id));
        
        // fetch() is the PDO method that gets a single result
        return $stmt->fetch();         
    } 

    // Report building methods below here

    public function HTMLReport_styles(){

        $html = '<style type="text/css">		
				.logo { max-width: 720px; height: 50px; padding-bottom: 15px;
				background-repeat: no-repeat; 
				background-size: contain; 
				background-position: center;
				/* To keep this project compact, we show a base64-encoded image, not a real file. */
				/* Excellent base64-encoders http://base64image.org */				
				background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAAyCAYAAAB1ROw8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAF2/SURBVHhe7V0FgBXV9/5239v3trsLWHrp7k5FREpCVERUFBEUETAIRQUkLTpEQVQQ6ZaS7lo6trt739u3/3PuzOy+Lcr4of/5YHbuvXNuzLyZO989c+65FgUEqFChQoUKFSpUqFCh4oEgCPS+O/uw7eZ22Git5WQzML22kIJF4IT/Du82WRTAKleL7jWfQNPAxnR2lvIRFSpUqFChQoUKFSqKQxDoiXsnYvqW6UAZ/LmQJ5tz5pKEWonz8fJkHgdw28pqF6elA7P6z8eYtm9AA62UrkKFiv8UCvLzYaKOQKNRn3EVKlSoUPHoEKpWa9Y8M3m2JiZpvulps5X2Fnxc7PmYFC6Us5I3CluwjPmxx2Ijjszt0hVPKwzrAZ3eGtYaCjyWzF+FChV/BbJSkpGTnCTHVKhQoUKFikfDvW0VmEuapL1QLCv7kiSTS5FLKmCZEocfB4h23fNsudGK+lyFChX/ReSkpSI7NV2OqVChQsXfh107tyE8LFSO/f/F+vVrkZT031NclE0pS/JIC9n2wZxjlsc1WYa3xxHF2lWykTxSUAm0ChX/ZeRlxSM1KlGOqVChQsWjw2g0ICMjA2lpKbSlyalFWLVqKa5eC5Fj/3uwz4j09PRiW2Li398ffvXlbMTERsmxvw98ftmGFOQYSv8WfwdKE2jmkMwlFZTkmZyDjxfLyZkeY/L5ODdNdYKiQsU/hDxY5Mfg7vHr9NzJSSpUqFDxiFi7djVaNK+DIc/1w+CBvVC3bhBmz54uHwV0Oj20ln/NfIvY2GhkZ2fJsUfD+fNnUKOaH4YM7o1BA3qJNndo1+Rv5yF6vR6av+g6MLKJIN9NOYlDoUuw/Ozz+OD3ILyz0xXv7vbCpH01MGl/dby7ywdjd7nj0z8a4/sLr+BC7CbEZFyDIT9XLuXPozSBZsJsnlrywnK88HiBpJx+3FGyjeKclK0IFiUGC+Y3VXk32J+98f6OG/fvfhhUqPg3It+QQ894KiJO3YYhN19OVaFChYpHg05nha5de2DT5j3Ysm0fzpy5jt27tgqTBYbgFCWVkI+IObOm49q1K3Ls0dG7T39sFO39HZu3/o4Ll25TO/+iRv7NSMwKxe7bs7Hm4ggsPNUXm69PwtWEvTCaDHDU+8DNugJcbSrAXucBK40Otlpn5BozcDv5GH65PBZLTg/Emkuv40TkamJ/5priR0NpAs0Q19KchMkXl4mZsHSgvRIuhrLS/sfg9ij3Bp+Sif4oNwvHzclmidHAP0Gg/44bVyXQKlSURmbcRRTk58LGwwFXtpySU1WoUKHi0ZGbmy2HAK1Wi2HDRuDC+bNySnEkxMdj29aNuHTpgpwiIS01Vezz8gzYsWMLDh8+JOIK2I46NS0V6WnpiImJQXR0JEym4kqAvLxcIu4/IlUuqzywFjs/v3wFArdt+/ZNiIgIl1NK4/jxw9i5c6swXykPu3dvp/M4IMJWVlb098/xku03P8c3J57GgdAFuEKk2cnaB+0rvolhDX7AhNbHMLr5LrzZbDNGNt2Et5rtwHstD9OxNWgX+Dqc9X4wmHKIcJkQlnoau27Nxqwj7XEm+le59EdDCQJd8gQpbkEiTDqVY0T4LCnNUt4XMOnkGXoKcf7r+eCfBLXPUm4Un4eGwhyloAW129znc0niaWlZdMw8bA7zdJOp/NFDeaT2ryDQ5mVzuLy2lgeVcKv4r4Pv8PTIkzAZLOBR3QcnV+1DXuZf9ylPhQoV/x9RAJ1OJ4clbN78KypWqizHinD27Cn07fsELl0+jxmfT8GAZ3siPV0ioF9/PQcjXn1RmFacO3caK1csQvt2TcTEOybKo0YNR3x8LJYtX4jx497C998tg8FgFHkV9HyqEwICKmLoi88iNiZaTi0Nnc4aGo1GjhXh7p3b6NKlNaZ/NhnHjx3BG6+/hMHUnqysIrORgwf2oU3rBli6ZCEOHdyHp3p0wDtvvwGD0SBLgI59i6ZNamEnDQTWr/sJz/bvAWtr64fmJQouxG7B5P01hebZxcYPzf1fxNR2IZjY+jierPoBarh3hIu1n9gc9d60ecHZ2pdk/VHJpSk6BY0mcr0D0zuHo1XAy3C3qYx8U54g1L9cHoOFp/ojNaf863UvCD/QUw9MxZQdUyTXbsXUtbyT2KaFIMtEGGWNbgGRUQsmppRospBGM5aUxfQ3aFT/FAQ5pDbJEyG5zQW5dBI8EZ/uIQtHitMxXYY15vSZjREtXqPk0jcXgwkyE96SpJcJKKcpRFQ5zvJl3TSK/MOgvDyczptSD48s+eEo2ZYHRXnnqELFvxlJt3YjPfwQdE7BuHHCEmGHo+AW6Iknpg2WJVSoUKHi4bBx4zp8t3IpatQIhqnAhLDQUHh4eGL6jHmwsbHBy8MGYciQYejQsYucowhj3xlJhLU7uj/RE4sXfY3de7bjl1+2ykeBqVMnwlpng/ETJ4n4e+NGY/grr6NatRoibo6srAy89dZrWLp0NfYf2ItbN27g5eEj5KNFuHLlEka+MRzNW7SEKd+EtLRUPDtgCFq2bIPnh/TFM8/0x6DBL8jSwIzpnyAiIhRffb0UsbExGEbn8+FHn6BF89ayBDBm9Aj4+Phi/IRJOHHiKD75+EMsW7YGnl5esgTQqUNTLFj0PbW9upzyYNh352tsvP4hkd5KaBU4DC39h0GvtZOPPjoOh6/Aicg1SMuNgdbSChoLPTpVGo0mfgNliQdDOUMCiXwxmEZZ5GlRkEBpkSaY5K0gkohbDJFGStfmaaggJqIkzFmLsj8cHjXfvSDaROSTTzWH2hhhgn9OAIZ3fBX9W/ajtmvleiWNennkmVEeiVXSHpR0Pgo5VfKcOHGCbs5l9KD9ImbPcjqT58zMTFy/fr1wZMnpj1IPl/Uo+VSoeFyRFnEcSbd/h7VzAIw5Bjj7e8JozMPdU1dx5qfin0r/C/g7ulEVKlSURr4xHw4OTnjhxeHo0aMXJk2ahrnzFgjyXB7S09Nw/dpVoexKk00gsrIz0b5dZxFW0L5tR+ElQ0F2dja958s2mbC1tYenhxfWrv0eSxd/UyZ5ZnB7XVxd8PTTfdHz6d7o228gagXXQciVi3B2cSlGnhkj33wbiQkJiI6JxJ49O9C8Wcti5Jnx9jvjceHCOeGR5LcNv6Bv3wHFyDPDSmddqNR7EBTQYGTNxTew8dpHqOf5NN5tcRAdKo76S8gzo1XAS3ir6XbU9+qFjDz2QlIg7Kn/CFsqCTwgShBoc+IkHSrILUBwUC2MeWksvnpnAZaO+Q5LRi/D0g+WY+KrEzH6pVHwcvaByShfHN6Vd53udwELD9+rEIJ5Ofcqkw+xxlxDxDmPiLOrLz5/eyb2ztiDJb0WoU+tvtCb9OK0NUQc0zLSsPSnpWjSqAnc3Nzg7+8PL7oROnbsiM8++0yQUyawL7/8Mtzd3eHn5yc2X19fGmUOwa+//lqMfPKnj/nz56N37970kDnA29ubbtyncfToUUGChw0bJtJ8fHzEVqVKFYwePRoLFiwQ+c1vuB07dqBmzZro06cPdu3ahd27d4tyBw0ahGPHjmHixIk4darIrjOBbvoZM2aIdgUGBoo28vnUqFFDlMN7843r5jbWr1+/WDkqVPybEXdlA6LPr4KdS2VYWGqhsbZCzLVQ+NathIotqmLbvB+we/46Wfrfj1MLGiH+0i9yTIUKFX8njPk0IHd2pndoMNq06YAaNWuV+dWZcfnyBTzTqwuGPNcHP/ywApGR4dCbmX8YaFBvjjxDfrkqzrLg6emDRQu+xKi3xol4ZES4IOvmMOYb4e7mjubNW6FVq3bo1KkbPDw9EXr3DioEVJKlisADAXsHe2Rn5VB7I4iv+MhHimBv7wC9tR5ZmZnEO+JRoWLpcpgQPwy+OvEUzsT8ih5VP8JLDVbB2spBPvLXgb2C9KoxDYPrLEB+gRF2OndhZ73v7reyxP1Rxs/DpI1JoHzC9PveDLuGjVvXw83SGS/XegHDaw1DJZsqWLd1HdZs/RHRqVGw0JqRby61LF5bMq0k+S3MZ07kzaDI804E6Q8TViUsBYrA8lSmRb5UnkavxdkzZ2BIkWyHcjJzUMDWJyTGpgv2do54acBLWLhooSDLkZGRQrP76aefYsKECSJPo0aN8O233woiHBUVJTYmoLNnz0avXr2EjAI7Ozu8/vrrWLVqlTC2b9KkiSDOzZs3F8R2+fLlaNeunZgUwNu4ceMwd+5cDB06VC5Bwvbt2/HUU0+JyQFHjhzBTz/9hIULF2Ljxo1o3bo12rZti6+++ko8yAp4ADBmzBjRrnr16iE6OlqMZjnO+b///nux/fDDD2Ljtrzyyis4f/58MZsnFSr+rYg6vRixF1fDtVJHZCVchd6pAr3cTEi4FYGgtrURsvMkur3xLM78ehBfd/4AhuziL7B/I0z52TAZc+SYChUq/l5YIJ9IabkoKPoSPGvW53j11TexcdMefPzJDHpvd0R29sM8qwWwKIecf/rpJDRs2Bi79x4R5iAXLpzFb7/9grj4WFlCgYUg0SUnEfr6BeDmretyrAjpGelISkkibmSP4Fq1cfv2LflIEXKys8Xm4OgEf/9A3L17Wz5SBOnLeAl+Vg42XJmI2ylH8GK9ZehS+R059e9DHc8nMaz+KuSZcmBloUfaQ9hDl/1rFBJY2pOEwdKAO1F38MeFos+dy9YvwfW4q0jITQDYCoJuEiVXKQguzmSWJMxJsyC/clwZoJQg1RbmExgVhl1YkRLg4xzmTZZXkuiPML2wskR4bBg2H92ASzcv8wGYKF3R8haw/QkFLelfo8aNCkks//A8g1QZVfKefRpOmTIF1atL9jz29vZwcXEpNJ8wB08wYM0ua5hHjhwJDw8P8UBxGQwm0MoDNnjwYFG+8vlHSX/ppZcEwf/666+FNpnBclwnl7lixQqRZq79VupgDXrt2rVFmq2tLT1kDVG3bl1B5nlr3Lix2JiEz5kzR4RZe61Cxb8V+TkpuLLhBcRfWY/A5mORFvYHbFyDYKnVw5idDHsaaIafvY4G/dth75x16PZWf+Rn5uN95yGIvRohl/LvROWuc+EU2EKOqVCh4u8Ev5fv5dHCYMgrnGCXmZEBOyKiDLY93r1rG3TCO4VUDm/mKBBpRWVz3JBb9iD/yKEDaNuuA7RaKyxbvlrYVzMHqBxUVZaQwJrgstpbr24DGI1GrP5B4hIKpkwajzq16guTjBbN2+Ds2dM4ffqEfFTC668PQ7v2nUR9/Z4djBXLF5dafZHNQHge3f1wNGIVtt+ajlFNthOx7SGn/v3wcQjGuy32Iz0vDi0CJDOWpIySg4/SkM5I5pylwMST/pks6Ie1AyKTI0BjF3EoNPUu4EA/vLaAjlMC/bgsLUrk+0DhcgqRFXWYVSLcydFeyMlhPq7EWZQJLpVnwX9EXjmdIbx/yJvIYwYhIwvmU6uI17LPP5OVCdnaXCTTS7QU+BypLJIS0a5duwryy6sL7dmzR6QxFJLK5hAdOnQQ4ePHjyM+Pl6EzaHIXrx4UZDZ7t27i3hJlGUbpKSdPXsWsbGxwtSjQYMGIk2BIvPcc8/B1dUVOTmlR7PmZXM4L6/0A2guw2YlcXFxckyFin8P+D5ODjuCs6u6UD+kJTI5GwmX19GDqIOtVx3kpUeSkAU0NjokhcYioGEVOHq74siy7Wg/7ilU7VAX02q+jgNzN8OQ8+/00OFWrRsNFqrIMRUqVPydsLa2gaNj0Zffkujc9Qls+PVn6puAaZ/OxNy50zHtkw+F54qne/XByu8WCznW8NrZFrfvZR/T9g6Ocgx4YehwfDLtQ3z+2RSElSCoK75bixdfeBZ79+7Ct9/MRafO3YTbu5J+o5lgO1F7iVnJKRKY6yxavAr79u3Gq6+8gM+nT0H//j3g4uyKyVM+EzL8VXvxklX4eOoHGDv2TUybNglPdG+LXnQer702SsgE16yFOXO/xUsvDcCkj8bjow/HYfjLQ9CqdVviQ8XrLInQ5FP4+dIYPF93MSq7/vNKAButI6Z3joCnXVVkZKfhze+6ykfKRxGBLj74KYQgVyxFvJkvvlbOYqlhZssBIqiUl13CFf4okoiAdIwCvFnyVEPKZCwQIpZGPk5x/szBwiQjcU7xRx6xULk8MuNylPIpzJpiKY1CrD2msFSJXB7XxYXxfwPFWYb+8xxBRVMslyaDDxahc+fOhdrekydPFo4OFbLJGmAmxOz3MTk5WZhWlIclS5agW7duIlxqlGlGXs3DCk6fPi32bAJy8+ZNEVbk+PyU8t56661iEw7MUVa5JetVyhkwYAB69uwpwipU/FtgzMtCxImvEXboM9h41IB/05FIvrGDnnET9A5e0Dn6Iic1nPotHT04BchOzRQmXXbuDuI5OvvrQbQf3xMV6lbFlve+w/eD5iI7pXwfpypUqFDRmYjq2HcnyrHSGPzcUIwePU6YeVSrVhPLV6xF6zYdiKDOxfBXRmLmjC+FHHvCGDDweRFW0LRZS7z26ptyjOJNW2DVql/E5D8/P385VYKnl48grkx5OnXqjgkTJuP110fD2dlFlpDAHjwmvj8FWk3pVQH5y/fSZWvw5qh30KZ1B0z/fC4mT/1cPiohMLAiNm7ajUHU1g7tO4nzeXn46/JRCY0bN8O27QfQtduTRK77UZk/YMLEKahQIUiWKBs/XByBBj7PoE3gK3LKPw8rjXBFh5nbRiLXkIVYemfcCxLVZe5YSHo5IpM8/jUEz6I9c04ijQosOEGIsXs7E3NWkUpsjPZm5IxeVqxA5vKF0jiP/mQC+jRr6FNsYJloBaSSDE9C5OxsTiTMNliWKsigcJYFtPlWUtFZ1JQsIs2JVH8ayeSahCmGdJAz0Z4nDRIhLDBQOJeqzrCEhuQtE6kCyp9vKvJZKBrFbTc3cpeLevbZZ8WeJwfeulVk+6OQzaZNm6JOnTowGAzYsmWLSCsJPrZy5UpMnjxZxBVTkPtB0V4HBweLPZPjUaNGic8syjEmvkqYNeaParvMZSiEmjXZPDFShYp/C4x5Gbi9ZyJSQvfTY2xEhTYfICPqHPLSo2mwrBOE2piRINkPFj47QHJEPBoOaIfM5AxkJ2fi5Ord6DVvKNyr+OLG3gtY0GXqnzLpyKd2ZSffQmZ8CLISb8CQnSQfKQ1++vIyYmHILP4ly5iThqyk28hKuI6ctEhxfvdCZvwVqqeML2wlwGVlJlwVW05qBJUrd3plID8/j87jDkz5Zv0mISctXJwXb9zOB4Uxl65L4nXR1qzEa5T33gs/qFDxuIIn0Hl6Fvc4YQ6tRoPqNYKFoo3h6uqG9kQ82dUdo0ZN6f3ORLck2bW1s4Obm7sck8AytWvXK9NclGU7duxK9dUUcZb18vIWYQX8Jdzb21eOlY26deujdet2qFylmpxSGo2bNEMrkmH3dWWBlzDnMliOwdeopL9sc4TE70Jqbgz6Bs+SU/532HR6Gc7dPSBWN9x/9Tc5tWyYM+JC3ixFpBeNRC5po2NSFyulK/6ghe6Yk6RkElICDMohFjGhPedPoR/HuTYmdX8fP89aj+9mfI8dc3Zh/uAv0dm3C2zTbOjGsIJlgRbaDD1qWdfG8zWHYMcHO9DMqxk0sVq09mqHta/9jAPT9mP9yPVo6t4clpn0wyj9P1dHBFebpYVnrieG1HgeP09Zh/Vf/opNM7egb61ecMiXPpWINVX4hWreZIYc58mDCphEM1heIcGseWbzCsbBgwdx5UrpZTZ/++034bGDbaDvB9GWEmCSrthEX7t2TXjQ4LoYLM/El7cWLVpgxIiyXdeUBfO6OPzll1/izJkzIq6QaRUqHncwAby1410in1F041oQeR6PvNRQZESfgkZPzzkTaOfKyE65BUsNP0d8bxdAb2+NGwfOoc5TLaiMVOgcbJBwKwahZ6+h6+Rn4eDhhPTIJCzsPAVXtkvPxYMiNz0GkScW4O6+qQg9OB3hh2fRNgOhFI86tRRZ8VdlySIUEEmNPr0U0WdWinhOShhiL/5IZUxB+KHPpPwHplF505BwbRNMxrJNTG5ueQOpd/fLseLgPKlhh3F3/8cIo7Ii/vhCbGGHPqWypyD59h4i/ZmydBFyiLyH/v4htemOuHqpoQcR+sdMhO6fhvA/ZlD+6XRuUxB5ciEyyjg3BdlJN0nmWyEbxnUfmS32odSeqJOLxSChsB9XoULF/xusvfQWkeeZsLNylVP+N9hxYTUWUF/naOsGK60eIREnkFdOX8uQmGBp3lYI5lm8QEoplMwjZOgPa3TNoUSpX+5SuSM2vPsr3us6HvPnfY1li5fgzL7jeKvJKKx543sMaDYA+akG2Ols0K9rfyydsBQrhq1EN5eu8Mj0wJtdRmH92HWo7V4HDR3ro0/VPlgxcgnqe9WlXl6uhxtG5+uvDcQ3r36DVUNX4fCuI1jw9UJs+mUrvhm5AN2aPSkkLZko8iYPBsyhaJmZ/DJ4Al9JHDhwQNhI88jq7t27wtSjJDZs2PDAxLYkceU4j1wXL15cSHjZjKNHjx54//33RZzJvEKk7weWZc8gZeHChQvCzyTDnFyrUPG4IjctiojqV0T60gRRtveuB1u36kgI2QCdrScKjHm0d4elzh75ufLKSTJYg5OZmIrczGxUal6TysqGvZsjbu4/D0c/J1TpVEd0C1qdFb4bMAsxF+9KGe+DlLsHiFR+jrSwI0TKfeFatQe86g2BW7VesPGoKSY0hh+Zg/grpTUbpgIDLLQ6ZMRcROTxr5B4dRN0zv5wrdIdbjV6w9m/hSDasRd+JCK+qJS2mmEqyC+lKWawdjvqzDJEHvsSprwsOAW0gnvtAfCoMxBOga2pszERgafjVC9rls2RT+Vx/2IyZCP2/GqqezEMdO0dA6mM6r1oexp650AacJxA5NHZSAkt7VubBzrhRLrTw0/A2qUSPKlun0avwrvOcxSviIyoE0SmpyM+ZH2ZJF6FChX/TVyK24q8/Ew08/vfLmp14tZuzN8xFk42roID6bU2uBp1BokZ5XvlkAg0c68ySGQhHpRPlZATWmp6aVmYrIAMYPGbCxFkWRVvzBqDPVe3Y2fYDkz4eTwO3NkPD3jhpQ7DAer7M3IysW7PWkxbPg2pBunT4Mt9h6Fag6po+H5DBE8MRrcvnkRkVjhqWNfAwCZ9oLXUSvWb6JSSgS9fnY+nqj6Nl34Yhtl7ZmJHxDYsPvgtXvryRWhkDmmSbawFBP8sIqEKifziiy/EPiIiolDbzGCyuXXrVuEqjj1XMNgtnDnYxR37VP6zNsXs8o6JuGJawfbQn3/+OWrVqoX9+yVt04OQXnaDN336dEybNk2YlPDGYfYnzWYmvNymChX/FoQeni5IJBNkC1M+PGr2Q9KN7dCyz1B6HphIWtl70WOdz/YUIq0IFtBY6xEdchdNnutMZDoNFhpLGPPycWXvabQZRYNsHsDaWMHewwnLehP5i02R85aNpOvbhRaZzSGCus2Ef4sx8Ax+Bi6VOsK9Rk/4NRmBwHYfQu/oh7jzq4hEb5RzEqhpGit75GXFIpbLKDDCv/lbCGzxDjxq9SOS+hS8GrxA+T+Cd70XhCY5+uwKYfttDgsaGFhYFv+8m2/MJeI8H6lEbN1r9kHFDpPhVZ9IfZWucK3cBV51nxPlehCpzUq8jrsHponBhwJLLtPKBonXtyH51k44V+yAwPYfwaf+C0Tse1KZveBH51qh7Yc0YPFGzJnlSL37h5ybyHtmDGLOrqTraaJ8H8Kv2Ui4VO4MR/+mcA7qAN+moxDY9iPYetQWJD8rrvSXPBUqVPw3cSF2K7oGvSfH/jfYe+kXfPrbK0Lz7GTjLvikhvrR+PRIpGeXb2JWpIEWXPIeWkw6JAnfA4Iwc2G8UQZ6YVlSmcKJth6why0LIMoUBbBi15mkbICDpyWNhQO79WBrDMpj1BlxOewysk2SNuJW/C2M/PgNRBaEo8AzH4dCD+B4xHFqkxbVA4JhY0EFcbWp+RjUYRB6VnwK285txi+n1gNsBsSTWX2APyKO4cilY1wktYs1t0VnVdYsUXYzp4B9NCsICQlBeHi48POseONgbx3F1o0/eFAsYMJmF48Cc1LMPqbPnTuHgQMHFhJdbgPXzWkpKdLL/V6aaNaqs4eNsLAwMSBQNsU26UG02CpUPA6IubRWfPLXWLsg35AFO6/awt45J+k2EWp+PtgnUAF09t6CZJe+twugt7XG7eMhCGhQmTh2PslQN0VpoUevQe9kg8ptayE3PRvWdtbIS8/ClonFB8jmyEq+iehzNAh1qYSgrjOgd/Ap9vwqsHWrgortJ8MxoCXiL64loimZYzF4oRdjVgostFYIaDmWZErPRNdobeBW7Qki0c8jI/oMkmnAcE9Q3xtLZD0r6Rb8Gr8GzzoDYElkuCR4cqVHzWeItI+mwUiBMPMovGZ8HtR38LV1rdodPo1eJqLsJh2TwWfKrgIrEEHW0rG4kF/o2lE/T8iMuSzspH2bjIJtGR5CuHhrlwoIbPUOqj7xJex9i3sbUqHiccXRo4eER4oJ49/Gu7R///13iAfsRLYZD/h1/Vq88/brmDh+DN4b9xbGkdzEiWMRHy95u+JFTObMno7Bg57B88/3xby5M5AhOwTYunUj3h4zAhMnyHnfHYXx740p5YWD0afPE1i5YokcK0JERBheHzGU6nwH777zJj54fyx++eXHwi/O5jh//gxmzfoUr7z8HAYO6IXx40djy5YN4tjxY4cx9MVnKV786xl79lq48Cs8P6RfmWXeC2k5MYhOD0E97/+d44K1x+ZjxubXYW/jxK8FNK/aDXqtrej/bKzscT6sSBlQEvflxIWggku/DswgDtIfRYjkufu1sDBJZtCET7dOx2cnpuFqaohkcpEMuGmd4GRPDSfwjHmRiaEBco3ZMIpZhcC2I/SiYNLNfT9XY63BnUjpU6OVhZXkzSOfyrNzQ78GA0T6lfhryNLQjcg9NBdDZ5tekI6o5BhxnIm9qFOGUjVDeflVqFABffv2FWEmxDwpkPH777+DFy5hv879+vWDo6PkboaX2FbAi5s88cQTIvxnyCnn5Y3NSVavXi0WZlG03gxeGIW1yKGhoYXtLgvshoZNUdgkhBd04Y0XZOH8vDDMw978KlT8L8AT4BKvboK1Y4C4341EkN2r9kRuWgQKjLmUxt0ae5YxCvMAoyG91Ac2fhytbHSIuxlFZFAPOzcnIuJGIqgaGLJzEbL9JDqM70P80ySWv7V1c8TlTadw66DkQ94cpvw8JIZshKXWmkjiSGjKIKjFQA0JaPUu8vOzkcR2xzQAsGBfm5Sen50E9+D+0DsWn2VfEs6Vu8DeuyESr917kktm3CWk3t4P95p94VypvZxaPtgMhl3hZSVdR8qdfXIqa/PziBi7wKOW1LeWB/a1zeYZ+bkpSAuXPBMZDRkw0WbvW0/E7wVb9yqlNOgqVDyuYIXUyRPHcPHiOYQTUd25Yyven/g2Fi76qvCdHxp6F0eOHELIlcu4efMGrl2/ils3rtFzIXGJYcMG0Xt9BRzsHaGz0mPp0gWIjpEGnxER4ZT3D1y+fBG3bt3A9WtXcOPGVWTnFP/yFB8fi8sXzxMv2VmoTFPASj0m+ufOnUJ4ZBj27duDTz7+QLijM8e3387HmNGvYdmSBQgNuwt2o7dj+xZ8+818wXt4fYiDB/chIry4iRcr5q5dDcGBA3spXNrH9L2QmhcDO50bnG3u3d/9XVi672Ms3f8xvJwrICsvA02COhBNtBSaZ36P6LQ6hCfdkKVLowSBLvaKkfcyyudlElicZeRsbL7BnzKFHkiTD0tXDebt/RIffP8RIpLD0bRyS0zoMR5L3lmK7i0lm2SpjKJCLLSWhfRWp9cKUi0OcatJLDNXdjPFNypnI1JexaMyGlSoDwOx6cikCEDLx2RvFSxDyGeNOIPTpZCEMsgn2w0rGmb2yaxM4Nu7dy/at28vFlnhZbB5tT+GuZaaXdu9+OKLInwvYlse+Mbkh5Dz8sZxbk///v1F2ey6jhdxYbApBy8xfi8SzB48eOIjQ7HxVsAeR3gwoELF447km9vEanvsVYOJncbGBVaOvsiMPccMThKix57Jr9bBn0hpGg3iWR9dHJZEljMTUqCzt4GDj4sgytxj2Tjbi1UKPYI84eDtTASX+i/qi/R2emx6b5WcuwhZ8SFU93m4VOkuXOY9KAJbvYcMypcVG0LPt0YyObF2gZ1XLVmifGiIqDpVaAtDVhLy0iWFQEmYTAYk3z0gzDrYBORBwWTbQmOF1PDDfBGlfrMgH3aetan/uT+5tfeqC71TIJH3EBG34t9H74yk69tEXIWK/wr4/c/zKdq0boufftqE02euCZ/O7Ps5NPSOkNHrrcUaDR999Al+3bCdth1Y/eMG+Pj6Yc+e7YiJjsao0e9i0ZJVWLpsNY4dv4TKlaUFUNhrBhPtN94ci/W/bsd6yvvTz5tRvVrxr9ozZ3yCoKAqwu/zrVvX5FQJGo0lrOh5rlGztmjjkaPn0aJFG5w4cYQI924h8+OPq7ByxULiCPnYvHUfduw8hJXf/YzDR85jydLvxXlqqb8Uy3brpEXgFDA3YX/YvGDcw/KcqLTLwu+yxkLut/8hJGbEYswPT2LjmSXwc64EgzFbmG0MoT75p+NfwlbnQFIFdO20SJC/pJWFsjXQYuQkek0RFaCoOeUSIsphsZcjcriAXVxQBlMukUDe88iEkhoFNMK3wxdj6guT4BHggW82LcCaTatFVgHl+he2TEpgXXEhKFhAHbqlrNq24D3361SFg94B7lp3mAqMNGoqcvlUmJsCStGCPhe6b6LUYh5EisAaaF7Rjx8CJq5sS8yLoyjaZSaxffr0EeEbN24I0wrW7PJKf7wAyqOCyTKPHpVFWjiugG/o+fPnCy8fim00k/p7+aM2h3lZDF4qvHLlynJMhYrHE3mZ8UQKDxEhk79aGTJh511XEM+8zFhBFkU6dTrsIYj9nbL2U2h4S4CfAUOupAVycCeinEdh6g6srHWIvx4llryt1qkejLz4EKfb6hF/NZKIZaLIoyA76Q7ysuLhXWeQnPJgsPWoQeTdR2ihBYy5NBDwh0YnDYrvBysbJ2itnYTdclkwCXdxN+BYoTWVKZnPPSicK3ZGNpF7Pi/22s/XjydoPggs6JoL05msZLr2uTQ4aShMbKJOL0fshTVi8qcKFf8ViL7G7H1atXoNZGSkF+MfvPofk0wGOwbg9zfDlF9AJFkntLqpqSmCgDKfMH8/mygvyzDM8yqIjAjHlSuXUSO4FmrVqosZ0z+RjxRBfMU2c1XpHxAgyHJ6ujTHbOqU9+Hi4oqfiZxXqVJV1M8bt8XPL0DISF/CTbCxLd6XMMlnM1BF4/4wiMm4Aj+HOnLsn8HNmAt4/tsGCE24Dlc7L+QacwQXXDXiDIYvbQUXW2m1aAn0jihjUraC4izKHOJaFCeU5peH7ZQLD/MBUSE3Q5JiH8xOVi6o5B0EXb41QBzw2Yb9seSNJWhXvTUmffkhJi35EHvP/I5MnmGowPxHoCKV8xDk3bwB4qAUEslymPNb0Ka30MPLzUsy3TDPJ8JKglkFhKJQEfimYBJcv359EWc7Z/b57OnpWeijmdGsWTPhQ5kJ7+7duzFv3jzMnDlTPlocD3OjsZ01m1owzLXGShmdOnUSEwEVbN9+H5vIMsDlOjnRy1j2VclQVyNU8TjCkJNGBCxceKtg8MDcxqmSMN8AEV6xwBJBfPuSSSNPojN/zs2haFRtXR3oRSU/XySq0WmRFp0Ir5r+yDdI6WzeodFpcOanIps41oTnpkcQuaa+puwqyoVWbw9r50AYMqVnjXtPRSnwIBA9gCUNEMrxDc1ElT1nMEl/WDj6NyE+n039uEG+RtQ6Rbt/P3AfLPZG6rcNYkDg23QkDXRqI+7yzwjd/wnCj8xFHNuAh/5Bv0/pFVRVqPi3gBeYi4mJxsEDv2PJ4m9w8fw5VK8eLDiCAkdHJ2za9CuWLlmA2bM+w/kLkmtMXmwkn4jtnl3b8NaoVzCLjiUnFQ3Q+T1v5+CAfb/vwrKlCzB3zgwcPVLcJvfo0T9w/fpVvPfeh2jUqClOnjxWbMVh7ic0Vloiy6k4eGg/vlu5BKdPnRCa6Tat2yM07A6Rci2at2gDzxJ+o83BbbG1tcfp08ewmM7zm6/niFUPv/l6LqKji+ZSPQzS8uLhbnvvBVb+Sqw7sQDvrO4JJ1s3OFhLKzJm5qbhg2eWYtHej6C15C8KRf0cK2ptrcr2XMYoItAKp+M9d+IKySvibMXeD8LOUEngUsTohugzp/GfVKBXnWfQt1UfWNAgp4pvVXz73GJUsK+IV+YNx8nkU8i0pY6T33HCZlFugqhbjphVaBYsDUWe+vmcgjxkFkgTD2u4V4ddPo36FPYtyyl2z+KdWlgwp7FA8ZqUkcj48ePF/tixYxg7dqwweVDsnhnsh5k3Bnu6YJ/NbOJRFlkuj0ArdZkfZ60321szzD+PcFiRGzp0qNgzyiv7XjAvl8Hu+Up6FFGh4nFARuwZImT8eY3Amh8LLXQOXshJuUtPL937CgGlQSGbOTAKTIZS97gAi2stYcgzQu/A2iHp2eFnSG9vg4gLd2Dn4QRL7lD5uaIimETHmS2uUkAEPj8nHVqbh/dfamGpg1ZHnbhCIFnr9DCPL7eJ+9pySHe+IYMfbmrzw2mfGWx2wdr8PF78RdbeP1zXwterqF1WdH0qdZiCKl1nw84rGHkZ0YI8R59dimu/vYS7+yYjPeKULK1Cxb8HTBxv3LiOKVMm4qeffkDVatUxd+63cHKSlvjm/sTe3g4HD+7F6h+WY/nyRbgSUjSXYueuQwiqUg3h4aHYtPFX9O7dTZSnwMbaGidPHMcP3y/HSiK/Z84UucvNysrE3j074ePjJ7b69RuhYsUgzPqiaA0LfhStrHRIiI/HlMnj8cMPK8TCbD+u3QhXNzfERkcLbbObq5swR7kX2IFBCLV9zeqV+PnnNXS+q/Hrr2uFws2ceD4oco2pcLJ+9K/0D4NJ64Zg2f6pcLR1gZVQwBSIlQaHt5uM0Pgr2Ht5nThmDqPRAF+X8gm+xFwV7sjgPo/jSucnJCiBjvMkG8WUwsR2GSLIwgQhJy3RDUMBvBy8MaDtQFy/cgu5STno1qI73OCMiNhw3Im+DUtnkuTrTe8OnvXNEOSbVyRkjTntTFQOf75gWLC3DElMaiMfl+3VhTcNLoN++4iECFyV3SB1rN8BTf2aADyPkF6UwtSDv8ZyHQQNvRgsZa2KWBBGvCGUSopDsYPmkR27s2M7ZAX8eYbBE/kYMTExGDlypAiXRWhLEmEFSpjzKPn48wjbXXOdJUlAWaTgySdle/KHgFIO71mDzq772EWeChWPG7LiLhOBljQC7PPYgkiytaM/DBmx8qNr9jyJZVkpkd3YlQMN9Ql5GdlEZLVSH8CgLDobPZJDY+Ho7QydHX+elNI1eh1So5KQESd9+mRFAk+cyzc+wgRc6kNN+dQBauRPsmX0FfcEN5eylNENCFhoFC19+Z8gywNPbOQOVqsn8s19/V8EG7fK8Gs2CpW7zkRg24nwbfwmPIL7CU3+3YMfI+L4t1S3OplZxb8HubnZYpntmbO+kr7W0APp5CyRZwa/VxMSEvHmyLFYvWYD1m/Yju7di+YkeHv7EKleg42b9qJduw70vBYQGZ8gHaRnOyU1FUOGvESEdxN+XrcZAwYOkY4Rrl+7ipOnjqFBg0ZYt26tMOXguUxMsplcM7h/yMvNQUBABSxZuhoODo4w5OUWaoyrVq1O55ArJjuaa65Lw0KYfHTt8gTW/LgBi5f8IGy2v/l2OSpXribKeFjwfDRr7YOZrP0ZzNsxFkeub4enkz8sifcxv0rOiEOvRsMRRAP6BXs/gLNdSc9CxIcMGagT0FxOKQ3Bd0VHXBJy58xdurAcoOtqb21PGSRhGwt6OVHfX5BPEvx+4o1khNe5SOC5VoNRzT0IIXdDBFHW0giIUc2rGpoENIHpHBV6C2hepSme7yWtAW9toYN9mh0CHQNhq3Ggk2RyK42ILAW75gBt3C6KG9hmkaClfJb5JEfiYYmh2HBecrvia+WDz1+agQpW/ii4TNQ/pAAtAlugXWPJNZ2njQd0KZQpnrKy+YJ4E/EZlw32x8yoUaOGmDioQCGgw4YNE3vGCy+8IPZlkVzzNA4rccW2iUeDCoHmVQj5xmR75/Jw4sQJsW/UqFGhFlwBl62YZvDoUpl0WB7eeecdepBCxQqIKlQ8bshKvkOEtUhbzGYFllZ2NCgm0lXsUaPBPHvDEAN9li39HArQ88G2zxp6RsyffPYJnZ2SQeTZmvgtdTryIF9LA/Gc1Gzk0DGGhaUVrOw8YGQC/5BgH87sI9lKr2jUzVvwgCjntBi8mIxwjZdb/hLi5SEz6SZ1RGyyQv2woqn4i8H+sB39GxOB7ouAVuPgXrM3Uu7sRfKtXbKEChWPP/LzTcJjReNGTdG7dz9cvHBOaKPNYTDkwj8gEL5+/qhRPbjUst0MnoQ3fsIk2Nk54OYNaSIgkzieg+FFJNvbx0dMHnR3L5rsv3btKjjYO+DSxfOYMf1jrFixCImJCcIGe8/uHbIUj4X5i5wWlYOq4NkBz4k0dq3H3jVcXN3g5uaBU6eOY/9+eT5GGWCawvKubu7w9fVH9eo1BPnmNjFPeVgPHAydJfPCe3RifwE2n1mOnRfWwNe1ouBVfE15EmGn2v3xPPU749f2hbOwe5bosAJWErNJh79badebCopy8Dko/bdyPsJLBRGwfImANa3cSOwZLzz9AvysA+CU4QSXLBc4ZToh0KYi2lZrgxXjl+PTHh/jxq1rCE26I9zP7Tq2m/h2Hqzp36KxyzHn/Xn4edrP+GjERzh+9Kgos4JHAFZ9/gOGPPk8LNIsUadSXToxaSRXv3pdentSwEBNNlrAlv7VrSYZn/u7+8OHbRBpAFRA76L5O77Gxpu/0umY0My9OXZ/sg9L3l+MRZ9/ixnDZsCYJdkMNg1uji8nz8PTvZ5GZhp/7rz3C0zROisTBkuCySoTz9q1axf6fuY0hQwzOGw0GsVERB7t8RLhyvE5c+YgMzNTuKFRJhEods9sFtKmTRuxEiF/fmFvG0yst23bhpYtWyIwMFCUZSsb+HM+ruPOnTticiGDF3Zh7TLnYTvuzZs3F+6XLl2K1q1bY9GiRRgwYICw5zZvtwoVjwPys1MEsZNA/RP1VUwSS3be/CjzM8SPj3QXl+6kOZ3nbOTTfc5eOorJWNKLi93aWWlEx6o8CRzOp5eIIVfqQ3jCnI1rNZGeGiENZB8U7D0jhwYE9n7N5JS/9nmzsnOD3t4HGRGnFf7/wEi9uRPWLpWF/bLw4/83w8rWHT4NXoK1cwWkRxyXV45UoeJxh6QAU/qf198YgwoVKgmzijVrvhNpDDahSE1JFu98Jrdp9G5mTJk8ARs2/Cy+/PKX7F/X/0QEOA516khzrhi8GiprftmcQORNk7gDg00o2rbriO07D+HkqRAcPnIOO3cdxu3bN3H8+GEhw1px8zYOHPg8mrdoKUwxvvlmjkhbvvxHGKjMiRPeFiYm3L7s7Cxh233yuMTPuAyeo8H8xRx51B9y2wUBLd3N3hN2Og/kGv++lUfZNV1I1CnYUj+WRX0Kx+PSotCt7iCM6TYHb37XFY7WLtAqXwHNkG3IQr0KreDhIDlpKAsSS+OT5lAZnWxBXgGC3IPw/ksfILhiXZy4cwbH75xETaca+Pndn7H5w83Y/MFW2rZgzcjV+LzvTNR1qkeNvo6tIdtgyM6Dhb0GV+5ewIc7JuJS8gXYWFqjT+2nEREdjhemvYTVl3/AlZwrSKcG3w67jV+2/IwGVevixR6DcCP8Ks7ePYN2ddrh9X4jYZNng0DHihg36B142XviLLUnNT0JY54fjfqV6knE096E5xcNw8f7puFi3Hl4WnvgqeBeqKqvgeELX8OOczsRnhGJZUeXY8m2Zdh5YBd0tjpYsi/pe6Bhw4Zo27YtnnnmGTlFgrnG+O233xY+lXk0qcCciPJNyMSX/TmzGzo20Rg8eDAGDRqEw4cP491336VR5VpZWhrxffDBB4IQ85Lgr732mlhUhZfz5omLXAbnZe8fTKIVwp2UlCTI8KRJk8QnHa6DF1xh7yFM1NndHk905D1rt9l/NfuJZs25snIit1WFiscJwnxDvse54+InizWk5rPgGTzJmZ8FttqS7uJyGCS/FPjlUnKwSFF2c8cvBh6IK08CP8taK60g1gps3SrDxr0aEi7/DFN+2RP6ykL0qcXCNtipQmtRx18N9kvtGNAcOalh4GW2HxSZcVeI3EcSsW8sX+8/o4F+uD7EwbcRclOjYMyVTGRUqHicwSQzLi5GKKsULF32g5iUz5MCb964jnyTUfQbb4x8GVUqe6FWcAX4+Tnji5nT8ESPXnjzjWGoU6sialYPwIwZHwtb5o8mSY4BWFlmNORh0kfvIaiSp8gb4O+M2bM/w5fzv6C+yIp4SZNinjn4izPbQq9Z8z0unD/LnRZiYqORlFz0JWrmF18Lua+/moMVRJir16iJufMXokGDxsJ+umHDamhQrypq1QzEps2/ijxM8plQM4k3h1DW0eAgJiZKuAJ9GLjaVERqbvlLZT8K+HorYOI8/qlvsX7MDbzeaRqCPIPRuXZ/jO42C2+s7IT03BToy/HbbzDmollQF9jIJoNlwYJ+2IKp+6diyo4pgJ46u+LvIWpNAew1DnDSOMMyl4iioYBeTiZoLWhUw+8QXjqbsvHrh7tKfg/xBc3XGJFhSkMaL2RCcsKGORmo5lkNnvYeSM1OxdVo6qj1BlhZ6FHFvQrsrOxwIfQCDDojPBxdYW20pvro5qM6CnQW0NhoEJUZBR2NFjx1XshnTTJfK3pZWlpbIlWbjtS8FNE+tqO2zNSismsQPB29YDAZcDPmJpIMCajiXRU6k55IfgidM8nS9dPn2GBO7y/wWsvXqLmSxl0hvuZEkr1isEu7kjNOWZbleGTINz2TUSWdoZShyD0omGzz0t1KeQxeSZDtrLkNvNCLi4v0Oais9j4qHradKlT8E7i1530iWKGC2BWIF5NJLAOdSQQxI+q0RPgIJur8NHpnBLYZj6hTC+hethTaYu5bz+7KR3ayBbTUpyRHxKH/3Ddxbv0fOPvLAdg6SwPfnPQsVGoVjLo9W+P7QXOgIYLOcyhyM3PgUdUHg1a+BUefos+wSde3IurscrjX6A3vekU2iuUh6fZeRB/7Cm7BfeFd/3nqM40IOzSdul9LBLZ7X5a6NzLjQxB2cAa8Gw+FSwVpjsa57zrArwnbFUuLPxmzkxB2eJaYUCiW2rYr8gxQFnhCZMTRechOuoHK3WcL85S0mAuI/GM6/JqPhaN/0VfI8sC/S9SphcK9XqXOn4uluW1cq9BgocgutDzc2TdVfGWo2P4jaG0ffmKmChX/JNhu+OzZUwgICECjRsqXJOD8udO4c/eOWPzMy8sHV6+GCP/Jyjs1NzcHVavVFGYQfxzaLybhpaYlC/Jcp069QtdxbNN88/pV6K1tCvPm5eWiWvVgRISHIc+Qg1at2oH9M5vj9u1bOH7sD7Ro2Raenl7YuuU3ePn4om2bosWUQi5fFN47uNhez0hf19mVHp9PXGwssrMy4ermgQYNG8HfP5B4x13hAaRe3QbCZZ6CfBpg82IyrPUeMOC5h5pMGBK/Gxm5cWjqL5mVPCpORa3F7eQTyDYkEdfLE3bObH7hblsFtb26I9CxoZBjisTne+T6DkxePwRGknV38IO1Fc+XKTKn5XPiPnnlayeIYJc/CbuIQG8nAm0rZS5U1ogoRTiubLJIYdh8z5s5Aed0cYz+8DdVPs6KFh6kcDpfZyUvp/GeB1KcZj6QUWQ4L+dRwpyugONM6BVZ5RiXo8hy21iG03gz48C6NGsi0HMwotWrJFKkXboXHpRkPiqxLVn+veozP/ag7boXHrXNKlT8nYi5uBZxl36E3t6bblITjHmZ8G38GizyjUi6uYMItGLCxJ43dKjYcQqRuUX0+NMzUQaBTgyNwfNLx+PI0m248Nth2Lk6ir4iPTYFrV7uDkcPd/w8YoHw0sEEOishA1W71cPgFaNEPea4S+QvK/EanCu2pza9KqcWRwGvWnhjB+Ivr4XeqTIqUft45T1ub9ihGQ9PoA8QgW5SPoFmsEY57NA0WFm7wb/Vu8J1XlnITYtE9OmlYiBSsdMnYlVCxqMSaCbhFdpOpuvyEUx5OfBpOgKOvo25U5EliyOJrkv0mcViIRevun/uhapChYrHH6GppxEStwtPVC1uM/4gYNOPoxErse/O19Bq9ESaraBhMxJB9AqEDTN/2TOYcsSXwadrTEV972eIWBctBHMn/goW7Hkft+Iuiy+RTJytNDqxEuGk3ivRvqbkGKI8SHSX+zOF+DJvkuqXQQe5w2MZXhxFkFTeK2mSiNi0cppyDsUgH2N5JskKUWaIdPpjRRvXq7SB081lzAc2LK/Uw59vuW4F3D6l/ZyHy+V6eWPizHk4nYm1Uh+h6HOv9LmCXcgx2IyCtcAMTlfsj5hcskxEREThCoAK8UxLSxPaanMyy2lskxwZGSnKZPAnYja3uH37dqHvZdbg88a2Rlw216mA87Et861btwrbxOA6uF1sP81hrpfjLMcaa54YyNpsro/r4XawPbWy7CfXcffuXVEf18v5lXNRoeJxgb13XaElFU8qdZZMSHPTo6F3rsQPAT2ARSNv9uzA4Il+wsVdSZC40WiCzkaH3KwcGudLzyk/P7kZ2fCqUxHpCanC+5B4hqkIE4W9qvkKuZKo0P4jQRCTbmzFnf1TkXr3EBHuq8hNDRfa2IyY87h74DPEnPsOOnt/BHX+RJBnBaIOuQ0PBgtB6s1PzaJ0xws7z5rwafQqjPm5uLXzHcRfWofM2IvITrmDnJRQCl9CwpXfcHvPRCK9N+HTZEQheVYgNPgP0TSeO8Om05Z6e7G8OWuTQw98Sts0cV0y6cXF1yU7+Q7SIk8g/Nh8It2LYevVAO41esmlqFCh4r8MB50nbK2ci5ldPAgi0i5g3vEu2HtnHhz0nrCzcoGN1h46jS0RYGux6bW2wsOHg84djtae+O3qh/j0YENspP31xAPinVDJoyZmDtqAdW9dFzbRrar3QKBbNTQIbHtf8swo3dtyJ1lSu8sQnTQlKseYXIkelTal4+coQ5EVMEsXAbP0YhtDKbNEs5TyhY0ybYUvDDnOjSoke/JxTmbNN+dR2srvVlE+b3JYaMc5XNwK8eaNm4UrAPKeJ9oxmIjymvAMJr5nzpwRxPjKlSuC0PJLkAnr1atXhV0UH1fIsiLD6bxaIRNVPsayTGDZVR2ns001k93z58+Lsi9dulToxi4xMVEQX4ZStwKud9cuaQa7QoC5PrZ7ZrMS9sLB8evXr4u6mUzzxuAyuQ4u79y5c4J8ixe6ChWPEfS27tA5+qOAF0ch8ASZXCKCOudAul81hbbMbDImXLERhD/ocmbRKW4yMxOk50OA+gRjbh5cAjwReyUClnI62/fl0nPR6HnJi09JMMn0azYafi3GITP6LMIOz0DYH1/QfjbCD3+BO79PQmbceXjVHYygLp/LuWSwNj0nheqVBrQPAh4gGLMTKU+RTWJueizy80pPynGu2E74YXb0b47IE98i9OCn1CZu1yyEHvqM0r4WC9JUaD8JbtVKuMI0ZsOQlUjX88Em+7BZjSEnFYZsXokwiwh8MCpSuV71hiAj9gLCqG7puswS1yX8wOdIvbUHrtV6oEKb8XjQlRhVqFDx74arTQDyCwxIyLotp9wfV+L3YNnZIcgxUp9tYYWkrDDEZF5DTMY1xGXeREp2BLLyqC81GURfxDyI+2ZXG3/Y6txwPnYTfrn8Dhaf6o9N1yYjIzeBjkOQ57FPzMe0/msxfeB6ubZ7QzOFcCD0APbf3F9CiyvvFXAN/BJijYcSN4d4P/FxIr8sx8fLI2BlpRcmKQE5vyLLRXIdzK3vV64QFAF5p8jTXhzjvZLGBdOFyLNC15rd0DigEVVhicioSOHyjRdLSU5OFpP9mHzyS5adibO3CybTvPw12z/xRD02ymdiyppn9qPs6+sr8jIh5rJYc8xynJ/LYltqJtBM0LkMtmlmossrHzJRZu02e/RgjxisteY9p7GMj4+P8NjBkxW5LXyTcPnsTobbyvVxe9gGi+WqV68u0jnMxJ/rY1me7MDnxJrnoKAgYVPNdXC7lIViFE20OaHmFPlKqlDxj4FtnE3GDKTFnIWWwhYaK2Ql3YJr5Y5EHqNgyk4Ce+Xge5X9CTtV7oy81DBB5iy1VkIrGnOrgMgq3bmWBWKSc8M+bXFy1W5BkHlyYF5WDpFnD9Tt1RJb3ltFBJp9PWuQk54NvzoV0WZUD7k1pcGTGW2IzHvWGQgH9kFP/Y2lRgdrlyDh7ziw1VjYeQRT+0oqCbjfNMDGvSZsXCrJifcGu5gz0Pl6BT8LCzo3BmtVHKleXkq7JLR6BzgFtqS2DYKlzpaeXUtoraVJjIFt3odr1W6wsi3uC5WhsdShgM7LJaiD7ELw3mCtOi8SY+3gCwdfyfaQfWUzkfas/SyciMxzv6Gx1MPKwRPutfohoPU4OPo2EnlVqFDx/wfJOeHUH1jA1bZs0zJznIr6Cd+dHwZHvSeCXFqgbcUReKLKBPSs9gm6Vh6LdhXeQBX3NkIjzZMT8/Jp8G/KRh5tTKa5z9Nr7YTJR5YxhUj3VRy8uwBHI1YhJScKzta+YlIhczbuowymXGEnrRXu9kqjRC8uozxWpJDnsiBKouMmekPdS+6eUPJJhK0Y6FBBuX0rHTQjdxI4TdoVoqSIACUKNkijFLNq+QWsEEc2p7CzsxOEkskxg4+zw/M82Rc1m3Ao2lzeM5FmsIxCPDmNTSfYb7NCuPmH4rxsasGa6apVqwpZrlupn7XR3AYFrCVmjx1McpkgK2k8sZBJMmu6FXA+llPaxvUxiWZzDR4AKOYhXJfSZpY1r8+8LeYonaJCxd8Pt6pPCd/Jws6ZyDKv5JeTdAcO3vVhVLxg0CPHxDcvKRQaGxcRL/n45+cZ4ejlgpzULKREJRJ55sVUgJy0TNR6qhnCjt1AVnIGkT8tkXF6JnIM6PPVcCnzA8DWrSp8GgxDAJFm38avwCmgaJJRSQgNSbWniKR2lFPuD14KPKDlO7DkxU5k+DcdCXu6DveCpVYH9+o94d9iNOUfDY8avURZ5UFr7wnfRq8Q2S7tu7Y88Ll61CqywzaHtVMAvOu/AP9Wb8O/2VtwDmwlzl+FChX//9DQpx8OhS2WY+WDzS4OhS/FKw1/xMTWx4k0T4aN1hl3U0/haPhKHApdjNPRvyAlKwKVnJtjeIMfMaLRejxd/WO09B+Kik6NYWPliLTcOCRnRyLHmEa8Jh+2OheirJY4E7NemIVM/6O50E6vvvg6lp4ZhFvJkjvAsiD1WsyE/opNgF5BZR17qO3PlvEQ+fmNSRuTXEGaRaL0QlNII5NODrLGmN3WMCFlWdYU3wm9g8uXLwszDCadrEV2dXWj+BVhjsEzZp2dnYmUmoQvyGbNmqN161aIi4sXfhd5VMRa4CZNGiM4OFgQda6XybrBkCfIMC/ryV44mHBzO1hLzK7smHgr7nOYQPv7BwiNNc/IzckpWs2L218EC6GxZuLN9TLBZ+h0ekGoeQly9jMpef3gY9Jx6QWnxGlQQBtdFT6kQsU/Cl5m2rfJG8J+liesWdl5IjZkHXSOAUSC2TuHsNWijRc9uUvET15SV/yVwGNaQ04uvGtWgCErB1kpGWKZbmOuEdaO9qjTszn2zfpNkGpLKw1SwhPQdHgXeAVLs+NVqFChQsVfgya+A3EpdpscKw22kbbXuePtZruRmBOKZWeex5IzA/FzyBhsvPoRdt2ehd/vfoUdN6fjt6sfYO3lUVh4qjd+vfoeQuJ3Qq+xRyOfAXi21jyMbrYDo5puQe8a09HMbwj8HerBSe8Neyt3uNlUEvVkGBLF5EZ320oI9ugqt6I0hBeOyb9PxsfbPgYkTx4S+G2jhFkZqfAnBqc/TFiBUh6nlxdW8DCyDCVdwb3ylQzTuWnTrDC/3xy83mokJVkgj8grc0aekZlPoxSeSMQkM8/ILlIsCh1vG4wGYRLh6ekp8inIJeIcFx+HANkdDYNJrU7Ps0UtkZGZDmsba2gsrZBL6WzWYd4wJtFMWmNiY+Dq5gqdVieay65VDNQWa701sikfy9na2FJ5GbAn8s1lsMN1JtqKb0iu19q66NNrUnIiMtIzYSSi4eXhLlY+MuQbERMVLQYAPFAofqHKAxMV9ZOriv8Nos+tQsK1TUSQnWDMSYVv09fpbrREwuX1RKrdhS2wjVcwXIO6IvHqb0SE9YVeOHJSLJESHYs+M0fg/Lo/cHb9QTh5uyIzOR1NBnWkZ8cGG95aAkdfFySFxqPhoLZ4dvHrcs0qVKhQIU3qT0lJhqOTk3BTx+AvuMp8Cv56zF+FS4ZjoqNgRe9adkHL8zhY+aYouvj9za7gWEnHYS2bnvELnf7zpGGW5Tr4/a58WS6cv0GQuIOUl8vmcrmdrIBjhZ6euAOD5znxCorSm1561/NXaJZjKG3i8pKSEkV9jo5O4hjDvM3mbTI/T0WG97wpZZeFtRdHCYIrlkMvgdz8TBy4uwB7bs2Go7U38TLJ6wabZPC5lgS3mWe1mQqMtHHdBuJxRpGWT2FbK1d42FaksnzFREaNhRYZeQm4krgX1ho7CieignNTvFhvqVxi2RAE+st90zFt10Q46ZyE8lYcoI0vLINNG8zTFT7NuBe35gi7ZOY9p/HGx5UyzMNcBs/3s5Qj8v1y37LZDbUlJZYsj/cM8zLMwyK/UFTRJaXfyzpTh3HdxqBf40F0F9GPLLeB/0iaaYZEajmNJyvx78Y3niW7xyICyj+UuBHFf0txI4jZpaIgSuObjcL84yo3lSTL5iLsckWCuB/ognO9lpa8yhr/8HIZ4i/f1FSXaACFiQgrn0AL6CaRHHRzhE6Q/XVz+7l80WZul/SpmrPzTS+VJbWXIeqjNKU2Kog2KVwUMiEvOwNuftJqkCpU/NPg+zn2whok3Nwi+ii2s63YbioSQn6GIT0Wlux3VWMLz7qDkXL3AMnk0XNqKQh0VhKQSQPfocsnYkazN+EW6Im8zBy4VfZGo2c7YtuE1UgOjYMxz4jq3RtgyPdj5FrLRgE9y+aLufAqhrzgCg+8c9KyxTPDfaidqwO1QX7xKI+XGfgYg81PFJiM1N6UTCkPgV+iekdr8bxymw05Br4Y0NDL0NpRGijztZGW75WeaY4bcw2wsi7blo/NWTS6opcby2r1RXbVBUZqM5XFdeVl0IDc0baYvDn4mnGfw/bkbPqiLDrDbSgwsU140bkxEu/EinNyrXBvH9UqVDxu2L9/LyIiwuDs5IJOnbuJeUULvpmHYcNHCKL68ccf4K23xomv0GtWr8Tg54Zi584tyEjPgJVeh44dOsPe3hEbf1snFkQJCKyAo0cOoWq1GuJL8tmzJ9G4cXOxWMvxY0fQp+8AREVF4ObN62jbtqPw45xPpLdmcG3RnoiIcJw6cQzP9OmPw4cPoFKlqmIu1oEDe8XqhpuonqHDXhOymzb9KhRmdWrXg59/gPABvW3bFgwaNETM3dqyeQOef2EYLl++KPxY29raCR/V/KX74MF9cHJyRr16DURZ7IAgIiJU+JwODb2D1q3b487t27h48Sye7tUX4eF3hUzjxuWbsSXnROF4xPfoEjQWGuIoCg6FLcUfoYuRk58BRz3P7ZD6yEcH8zci0gVEqok7sRkHg31HW2sdiDzHwcUmEKOalq8RVyAI9InLP2LfuaWw0zlIjipEl1m8dzdPe5CwAukzPx+ROmIOM8rKxzFJkkZZ8lEpndNKhzX0V7qUUgm8L4rdP8x/NfRW4xebBZFmb/rnbOEISwONCInJ84UVJFWMHpjsymF6WxfQXlrBTEqmBCpRIqIcojcFhenFQeli1MgXlvYsKqoWZ0gvE5I3iR+QXyp8NF/8kCYqX8iKspVfpej8uVJBfFmA6xRhLoNLVcoTYpQk/tA/lqE2KXlFPpLlIgq43ZxGEZJXzkXKS5CKEKWwjAURhrzsdHR/9SvpuAoV/yMkETmOPrmA7sdkYV8b1HEaYs8shzEnke5brXCLxhMKc5Iu0d1rRwTahJSIbPjXq4ianZpgSZ/JcKvkLZ6JLuMG4tC8bbj02wk4eDuh3din0W50T0Eey0NabAr2zfwNvWYPFXH23BGy5RQ6jHsGRxbuxMUNxwTZ1NtZ47k1Y7F/9kY0HNgKzgHS/AVzXNp4TBDxWj2byilU3rVIbHpnOZFfPZ2fLZJux+HJ6c/Bq0YAtn+0GqkRichOy0JQ62B0nzpQ5EmLScbBeVtEnIlwenQyji7ZjVYjn4SdW3F75+t7LyD+eiRavf6EiLO52YY3l6DfAulFe2P/RWEnXqdXM+yfswlXt5+BzlaPLpOeRUCjykLGHOfXHaGBiwZ1ezfD719sRM0n6sOndgUkh8XjHB1rQ23gNjHR3vvpL7iy45zoI92qeNFA5W25FBUqHn9s2bIBnTp1x7p1a9GZCLSPjy9mfD4Vrdp2QOtWbfHB+2PRhsLduz+FRQu+Qr0GDZGTnYP2HTrJJUirDf6+d5dQtvXpMwC7d21HkybN4ODojN9/34UORLIvXDiL48ePELl9QZhrXjx/Bj169qb0c2KlwoaNpP7i2NHD+OWXNZg95xvs2LEZ9es3hre3D7Zv34JGjZti5fKFeG/8JCG74rvF8PcNwOVLFzHm7fdE+UyqP/10Fo4cOYitWzbi089m4wANEurWa0jtTMPp08fRu/ezGDt2JAYMGIKmTVuIsvhL+akTx5GbmyXaxV/If/h+hTAF7dS5uyDXbCLK51IeuP+Nz7otJvKxO7p8Ux7WhYzFwbBlwhUdsw9Ot9e7E7uRNPR/LSyQmhsDP/tgvFh/pSDTCk6ePAqtVodgGqgo2nWGINCLfp+O2dsnwlHnLHiXIElCHSxLEXc0WRLZE27kiocLKCxkCebpIi/nI7LJRLOwDGZiFBb5yggLeQpzGxgWTOZYvUSHuR7zMJcnoiRTWLZC8pj4iahZmISV82L6ym2lGPIprzZbjzFd3kLvZs+gII/K4wMkw/+ZoFpYUA5hLyyfmCCaLCNDyBOUNI6LvCzH8kymac9J9ILkm0WgUIYCTFjFBZHTGIKAS/KswZFIrVyJeZ1m8oXpHBB1c7lyHoYsz2J8faRymSAoddPGEGGuT24rQ45zm0z5OXDwkkagKlT8L8EeOBKubkKiWEzFHr4NXkJmzCVKD4POwRduNZ9B8vVN1AfY4/zuAiTeSUeHkT2xb84GZKakwdHLFdU7NcLBmVsQezUcdZ9tha4f9herDt4PMSERmNfkXdQf1AYDl47E6R8P4eCcjXj75Cws7/M5qnWsj2qd6wovHoFNqmDtm19Da2GFfl+9Jr5Cnf3pDzQa1BaGnDws6DIFHd/rjdo9m8il86qI2Yg4fQvWDra4susMTqzYiwmXv0LM5TD89PI3GLjyLaFB1lnr4FVLMhn74+tt+H7UXHx4ciECGldG/I0ofD9wNoauHw/XikWaXn72V/SejrtHr2Ny5FKhsc5OzsII164Y8slodKFrsGPqWuGtpOf0F7Ds6U9RtVM9eAb74YfB8zH0l3dRpb2k/VKwY9KP1DcU4MlPB2Nes/eQk5GDd8/MoesUhu+fm4MxR2eKgcAvry0kYp+EfgtfQ156Do4u3U15hkBbjmZbhYrHDVu3bsS1qyFwsHfEK6+NxMyZn2DYsBE4SWSUl+n++uvZ6NmzL25cv4KExHi4uXoguHYdeLh74quvZqNr1yeFWcSlS+dw7txpfPDBJ1hPZJxlFbPOF18cjilTJgpttZ9foDDHvEjyTMpDrlxGTlamINBsZnHi+FGxciCvblgpqApOnzoBFxdXsaLhG2+MwfIVizBu3Aei7cuWLRBlsPb76V79EB8XS0TxGF6l89ixbTNatm6HNWu+Q6cOXXGC0k8QiZw/fxFOnToOK40WUTFRqFe3IXz9/MQg4L33RmH8+MmoWFHyIjRr1mcICqqKhg0bQ6OxxJ07t4TW/EFwKXY7frg4ggizNUY13Q4PuyCRzpMED4UuEeYWTKDZtvmvINJGUy6yjKmo69EDfYO/kFMlsAbemkjzrVs3hclL+w5d5COQ3Nhtvr0bG24cQLQ2B9HgLVfeF20xnGZROlwoS3GRLocL0wrKOC62ssNFMrwvEeZyRXlSWMhy3LzsAkWe9+WHFfkoSwpb5CKWXhAdGvZDy6pPiOVrdWLzlDcK25qFC9MfZFPkzfLZliyjDBkRluOyvL6UjPlmJl8szXxf8piUfv9yy4hTm/T29ycXKlT8E2AXbY5+jeFcoZ3wp5wecwZaO3caE+bDkB7NNgmw9aoFY0YiwkPy4Fe7OpLuxODWkUtwdHWFo4cHbu6+KAho76+Go9WI7rB3l9w43g/pMclIjUhCWlwSNNZWcA3wwJ0j19Hkxfa4su2sGGzm5eTAxtlOuMer2KA6FgyYgp5TXsDVHWextM+n6PhuH4Sfuok7h66ix2fFV+FjbS2TXis7HfbN3IgeRDI9qvoiMz4V13ZdgGd1P8ReCUMAkXPWcrO2ePdn69Ckb3ukRCYgqE0wctOycXXnOdTr27LQzIMRdyUCocdv0kDYiZ5rPbxq+NP1y8O1n84ik16KHtV9hekIl8lE+dKG46jZozGqd64HaxdbXFh/lMqUtFAKwo7fgIWVBpWp3mt7LsCUl4/okHDU7FYfIZtPofmwToi7Fokz3x/A4B9Gw9HbBXZ0rat3rV/KvEOFiscZFy+eQy8in4lJCYiMCocFDUh5ntOlSxeIwAbhwIF9dLyv8HbF2t0hQ4biwP7faaCqFfbCrLHes2cH/P0rIIC2kyeOwtfXXxDNZs1aCGLKy4UzCfbw9MJPP60W2uvDfxyEnb29ILbNm7cSpiM3b1wnQn0Rjg5OuHothAbnBejYsQuV01LYaXtTXdevXRFmG0yCq1evKZbs7ttvECZ99B56PNUbx44fpvRgHDlyCLZ2doiJIZaUk4127TsJ7Ssv2c15q1StLgglK+AqVKgo5Lg8HgQwtm/fjAb1GwvCefr0SZE3PDwMVapUE8fvhw3XJsJa64gJrY/BTle0pL+vQy00939eTPrLNCQjNvMa8vJzBNHmr/kPB1YwAmm5MbDRuqBN4GvoXnWCfKwIbD8eHh6KtHR21FBBmKkokPxAhx3Egdv7AdZMW1Kh3A5WSPK+MGyeXiJcKFsiXFK+LJmS4fK2suR5L+JyWImXt5WUNztmZbRCtxrd0SiwAR3igzKERpfkzcPmaQRJgyvFywyby5eT975lPEJYgOKUIEdkyGmFsuYyZYVpTyFJViQrdbBmWpZVoeIxgPB1HNCcyHRTWFrZ0CDPD1p7D+LPaXTjGlFgYYW0BGtkJ+URAU2Db81KqNOjmSC9zV7pjEZD2sHJz41I74Pf1+kxKTiz5gBe+Gkcfhz6FWp1a4jbh0KIQHfApU0niFwnIDMpA3onW/jVrQidgzUubTkBN19vRJ65Sb2NBmmRiciIS4Oznysql9DoKljaazp86wQUmlpkJqThwrrj9CwWIOrCXQS1qgk7Nwci71dxY+8FdP6wP06t+h21ezWDIStPmIfU7dOiGIG+tOkkctKyUKlVDWHKwWYabP98YsUeDFw+Cou6TEWL4V2QEpaAyu1q4dxPh+FD58CaeSsaLFzeeEJcM3PcPnRF9BdMoE8RSX5qxhBsfW8VAptXQ/LtONTq1RTJ4fG480cIGg1uR7+ZqnFW8e8EOw9wcHBEzZq1xAS9tm07CRvhqtWqC9vmqlWrCVthTy9vQTqZHDs4OtI71CTyMaF0d/NA3XoNhOaWtctBlSrDxtZWDFwV71tMkplsswybZPj4+iI7OwdVq1QV6QzWWLMdtX9AIKpVrSHSXVyk/Ox1i0l4rVp1BZnn9SPq128k2sLkuwa138/PH4GBFUnWgwhvHSLGlei8gqkN7LHLRRBHzle7Tj3R7nr1G4q8dnb28t4OTZo0F/yAy6pbtz61N0hMlPT29oWHh6eQexA08u2P2h7dhc/msuBtXwO1PZ9ADfeOsNbY43LCLuGejutmE1jmJ+LrupDmv9LG/0zIF+YhabmxSMy+g26VJ6Bn9amo6tZGSJcEe0TjCZ98Lv7+gYVzURgiJLiQ2OhP4b7kZp7+d4fL2/5MXt4UOd7Tptj3KtdX+lMcLK9ACZunEcwJa5lhc/ly8t63DMLDhgVKxhlyWqGsuUxZYdqXXYfZQEOFiscI7LqOl9V2rtQWnsF94VyxPZHVbxBzYQNOL9iDbR/+BO/qgej20UBU794QwU83gcujTmIjApuVmA4nH1d0/aA/Znd+D96yu7u87Dy0e7snBix6A02eay/SGBNPfY2Pew5H9KVwDNs0AQfmbcFZIqdtRj0lSxTHoflbqMsyodfsYWJSISOfiK7O3orSXsLQn98TWmnGye/2Cc8ha4d+ichzobi2+xw0Omk2Pvd7/JJRcGr57wjZegqnv9+P67suCDtl1gJnp2TBr3ZFdJrQF5+3fxNuQbLWhQYWPCmQzdmW9Z+Oap2LL/nN4AmVPOmQkZeZS4TciE8SvsPcp8YiKz1T9B8Vm1aD1soKuz79GTzZkUn81f3nRFiFin8L3N09xWRB9oJRs2ZtoVVmODu7CE0vE1IFivY1IKACEesaRGbriHwVK0nmCYzKlasIUst2tnyMzTuCgqrIR4FKRK4ZTMSDg2sJUqeAibribcvJ2RleRNoVe11uJ7eHXdeyNrhePWmBIybVDKWcACLffA5MlBk8cdDHx0+Qc24P1+tHmwJFG8v1MNHmPoaJe8k2M4lX6noQsIGpg95DjpUNraUefg510LXKOEzvFIbJ7S4QGR4HN5uKwlZaLH7CJsDU3/E8Mx60sAms1kIHD7vKGFj7S8ztlowOld68b118Tjyw0JaYC/P/hwEVvjPMSbIZWVShQsV/EiZjHpG4dPg0fBMVWvVDUPumGPDNCPEZlSey/VmwiYbWRnIN1fj59mg96kmhHWbo7a2x/o0lWPLkJ1jRdzoRRIn8MhrVaQfPGvRysrdF/QGtUaF5Ndi4lta4JIXGYd2YRWIS4cq+MzG/xQREnL1Dsg7ISsrEsh7TMK/lBOyd+StyM7KREpGIt098gdHHZ6LT+N64te+SaEdWUgbWvPAlvm3/IfbN3ihIa1p8Kj68tRBvHvoMNXs0xOXNp6C1pReP3DV2HPcM6jRrhgySY/Bkyt/eWYn5zcej7uCmaP9uL5FeHESy9dKLhrXjJoN0zi9+PQ7ZGZnihcbXrNfcYYi9FoZv2n2IJU9Mw28fLS023UKFChUqHhT2Og+0CBiKVxqtxehmO/Fmk614ucEqDKm7GINrf4vBdRbi5frf450Wv1P6aqHB/rMQkwinHpiKKTumANb/ZUJJxJl93hX61aM428yIOKBL12NO77kY0epVaIRdhwoVKv4LEBpR+qe4aWRXbGx+wFpUnsSnuHp7VPAEvpTwRLhVlrQxXC67ZnOv7C3so+OuRYl0C42lMJVQvuAwgWVzCXsPJ3nFQw2sHUp/4mRSHH8tWrjE443z+DeqDFsXe8RejURmXKpYhtzeywk+tQKRHJ4AJ19XoUnOzchBdkomnP3dhN1xBsmyltfBy1nYN7NHD/cq0rLfWUnpVA4d83RCbEgEvIIlTRPXx+1jW2VeUCbhdqywmWZ76bLAZJvrtiWCn0TXwcHHRbjP42vNpiDCXZ3Zqyb0xA0xyYjPSYUKFSr+LRAEeuLeiZi+Zbq0kMr/V6QDs5+dh7fajoSW/qlQoUKFChUqVKhQURYEgd53Zx+239wOa+1/nUGz+Ya5ll2Ks37KKs8K3Wt2R5PAxig2iVCFChUqVKhQoUKFCjMIAi2HVahQoUKFChUqVKhQcU8A/wfTXEsLNjUHqAAAAABJRU5ErkJggg==")
				;}
                body {font-family: Arial, sans-serif; margin 0; padding: 0; font-size: 0.8em;}
				div.title { width:100%; margin: 0;padding: 4px 0px 4px 0px; text-align: center; }
				h1 { font-size: 1.5em; }
				/* Assessment report views */
				.report-box { display: block; margin: 0; color: #444; font-size: 1em; background-color: #fff; padding: 0;
				width: 100%; box-sizing: border-box; font-weight: 400; text-transform: uppercase; }
				.report-box label { width: 100%; }
				.report-table-growth { display:inline-table; width:100%; margin: 0 0 10px 0; padding: 0px; box-sizing: border-box; }
				.report-table-growth td.content { 
					font-size: 1.0em; text-transform: capitalize; padding: 5px; color: #666; border: 1px solid #ccc; margin: 2px; width: 49%
					}				
				.report-table { display:inline-table; font-size: 0.8em; width:100%; margin: 0 0 10px 0; padding: 0px;	background-color: #777; box-sizing: border-box; text-transform: none; text-align: center; }				
				.report-table th { font-weight: bold; background-color: #ddd; padding: 7px; }
				.report-table tr { background-color: white; width: 100%; box-sizing: border-box; }
				.report-footer td { background-color: #fff; padding: 5px; } 
				background-color: #777; box-sizing: border-box; }
				.tg_charts  {width:720px;border-collapse:collapse;border-spacing:0;border-style:solid;border-width:2px;margin:0px;}     
				.tg_charts td{padding:0px;overflow:hidden;word-break:normal;}
				@media screen and (max-width: 720px) {.tg_charts {width: auto !important;}.tg_charts col {width: auto !important;}.tg-wrap_charts {overflow-x: auto;-webkit-overflow-scrolling: touch;margin: auto 0px;}}</style>            
                </style>';
        return $html; 
    }
    
    public function HTMLReport_header(){
        
		
        $html = '<!-- logo -->
				<div class="logo"></div>
				<!-- report title -->
				<div class="title"><h1>'.$this->report_name.' Assessment<h1></div>';
        return $html; 
    }
	
	public function HTMLReport_farmInfo($bPDF = false){
		$html = self::HTMLReport_farmDetails($bPDF);
		return $html; 
	}
	
	
	public function HTMLReport_charts($google_chart = null, $google_summary_chart = null){
		
		// this takes the base64 encoded img prepared by the corresponding google chart
		// if the action was to send an email then the src will be an absolute path to the image file
        $chart_image = !empty($google_chart) ? '<img style="max-width: 100%;" src="'.$google_chart.'">' : null; 
		$chart_summary_image = !empty($google_summary_chart) ? '<img style="max-width: 100%;" src="'.$google_summary_chart.'">' : null;
		$pdf_page_break = !empty($google_chart) ? '<div style="page-break-after: always;"></div>' : null;
		$pdf_page_break = !empty($google_summary_chart) ? '<div style="page-break-after: always;"></div>' : null;		
		// placeholder for google chart
		// want to make sure this is on a new page if we're creating a PDF document
		return $pdf_page_break.'<h2 style="margin:20 0 0 0;text-transform: none;">'.self::formatReportName($this->report_name, true).'</h2>
					<div style="chart" id="chart_summary">'.$chart_summary_image.'</div>
					<h2 style="margin:20 0 0 0;text-transform: none;">'.self::formatReportName($this->report_name).'</h2>
					<div style="chart" id="chart">'.$chart_image.'</div>';
	}
	
	private function formatReportName($reportName, $summary=false){
		$chartType = self::getChartTypeByGrowthStageID($summary);

		//$chartType = self::getChartTypeByGrowthStageID();
		/*
		switch (strtolower($reportName)){
			case 'emergence':
			case 'bulbing':
			case 'harvest':
				return trim($chartType.' - '.ucfirst($reportName));
				break;
			case 'threeleaf':
				return trim($chartType.' - Three-Leaf');
				break;
			case 'fiveleaf':
				return trim($chartType.' - Five-Leaf');
				break;
			default:	
		}
		*/
		return $chartType;
	}
	
	private function getChartTypeByGrowthStageID($summary = false){
		switch ($this->growth_stage_id){
			case 1: // emergence
				$chartType = $summary === true ? 'Average Zone Population (plants/m<sup>2</sup>)' : 'Sample Populations (plants/m<sup>2</sup>)';
				return $chartType;
				//return '"Population"';				
				break;
			case 2: // 3leaf
			case 3: // 5leaf
			case 4: // bulbing
				$chartType = $summary === true ? 'Yield Estimate (t/ha)' : 'Canopy Cover (%)';
				return $chartType;			
				//return '"Groundcover %"';
				break;
			case 5: // harvest
				$chartType = $summary === true ? 'Growth Stage Average Yield Estimate (t/ha)' : 'Plot Yield Estimate (t/ha)';
				return $chartType;
				//return '"Estimated Yield (t/ha)"';
				//return '"Bulb Weight (kg)"';
				break;
			default:
		}		
	}


	public function HTMLReport_data($screen){		
		$html = self::getReportDataByAssessmentType($screen);
		return $html; 
	}	
	
	
	public function HTMLReport_table($screen){		
		$html = self::getReportSummaryByAssessmentType($screen);
		return $html; 
	}
	
	public function HTMLReport_farmDetails($bPDF = false){
		
		if ($bPDF === true){  // building PDF output
			$html = '<!-- begin::farm & paddock details -->
					<table class="report-table-growth">					
						<tr><td><label>Farm</label></td><td><label>Paddock</label></td></tr>				
						<tr><td class="content">'.$this->crop->farm_name.'</td><td class="content">'.$this->crop->paddock_name.'</td></tr>
						<tr><td><label>Planting Date</label></td><td><label>Variety</label></td></tr>
						<tr><td class="content">'.self::formatLongDate($this->crop->crop_plant_date).'</td><td class="content">'.$this->crop->variety_name.'</td></tr>						
						<tr><td><label>Assessment '.$this->report_name.' Date</label></td><td><label>Days Post Planting</label></td></tr>
						<tr><td class="content">'.self::formatLongDate($this->sample_date).'</td><td class="content">'.$this->days_post_planting.'</td></tr>
						<tr><td><label>Target Population</label></td><td><label>Target Yield</label></td></tr>
						<tr><td class="content">'.$this->crop->crop_target_population.'</td><td class="content">'.round($this->target_yield).' tonnes ['.round($this->target_tonnes_hectare).' t/ha]</td></tr>
					</table>
					<!-- end::farm & paddock details -->';
		} else {
			/*
			 * $html = '<div class="float_left"><label>Farm</label>
					<input type="text" name="farm_name" value="'.$this->crop->farm_name.'" readonly /></div>
					<div class="float_right"><label>Paddock</label>
					<input type="text" name="paddock_name" value="'.$this->crop->paddock_name.'" readonly /></div>
					<div class="float_left"><label>Planting Date</label>
					<input type="text" name="planting_date" value="'.self::formatLongDate($this->crop->crop_plant_date).'" readonly /></div>
					<div class="float_right"><label>Variety</label>
					<input type="text" name="variety" value="'.$this->crop->variety_name.'" readonly /></div>								
					<div class="float_left"><label>Assessment Date</label>
					<input type="text" name="sample_date" value="'.self::formatLongDate($this->sample_date).'" readonly /></div>
					<div class="float_right"><label>Days Post Planting</label>
					<input type="text" name="days_post_planting" value="'.$this->days_post_planting.'" readonly /></div>
					<div class="float_left"><label>Target Population</label>
					<input type="text" name="target_paddock_population" value="'.$this->crop->crop_target_population.' ['.round($this->crop->hectare_target_population/10000).' plants/sqm]" readonly /></div>
					<div class="float_right"><label>Target Yield</label>
					<input type="text" name="target_paddock_yield" value="'.round($this->target_yield).' tonnes ['.round($this->target_tonnes_hectare).' t/ha]" readonly />
				</div>';
				*/
				$html = '<div class="container_center">
							<div><label'.self::responsiveDefaultTextValues().'>Farm</label>
								<input'.self::responsiveDefaultTextValues().' type="text" name="farm_name" value="'.$this->crop->farm_name.'" readonly />
							</div>
							<div><label'.self::responsiveDefaultTextValues().'>Paddock</label>
								<input'.self::responsiveDefaultTextValues().'type="text" name="paddock_name" value="'.$this->crop->paddock_name.'" readonly />
							</div>
						</div>
						<div class="container_center">
							<div><label'.self::responsiveDefaultTextValues().'>Planting Date</label>
								<input'.self::responsiveDefaultTextValues().' type="text" name="planting_date" value="'.self::formatLongDate($this->crop->crop_plant_date).'" readonly />
							</div>
							<div><label'.self::responsiveDefaultTextValues().'>Variety</label>
								<input '.self::responsiveDefaultTextValues().'type="text" name="variety" value="'.$this->crop->variety_name.'" readonly />
							</div>
						</div>
						<div class="container_center">
							<div><label'.self::responsiveDefaultTextValues().'>Assessment Date</label>
								<input '.self::responsiveDefaultTextValues().'type="text" name="sample_date" value="'.self::formatLongDate($this->sample_date).'" readonly />
							</div>
							<div><label'.self::responsiveDefaultTextValues().'>Days Post Planting</label>
								<input '.self::responsiveDefaultTextValues().'type="text" name="days_post_planting" value="'.$this->days_post_planting.'" readonly />
							</div>
						</div>
						<div class="container_center">
							<div><label'.self::responsiveDefaultTextValues().'>Target Population</label>
								<input '.self::responsiveDefaultTextValues().'type="text" name="target_paddock_population" value="'.$this->crop->crop_target_population.' ['.round($this->crop->hectare_target_population/10000).' plants/sqm]" readonly />
							</div>
							<div><label'.self::responsiveDefaultTextValues().'>Target Yield</label>
								<input '.self::responsiveDefaultTextValues().'type="text" name="target_paddock_yield" value="'.round($this->target_yield).' tonnes ['.round($this->target_tonnes_hectare).' t/ha]" readonly />
							</div>
						</div>';
		}
		if ($bPDF === true){ 
				$html .= '</td></tr></table>				
				<!-- end::farm & paddock details -->';
		}
		return $html;
	}
    
	/* // deprecated
    public function HTMLReport_body(){ 

        $html = '<!-- start::report body -->
				<div class="report-box">
					<!-- begin::farm & paddock details -->
					<table class="report-table-growth">
						<tr><td><label>Farm Name</label></td><td><label>Paddock Name</label></td></tr>				
						<tr><td class="content">'.$this->paddock->farm_name.'</td><td class="content">'.$this->paddock->paddock_name.'</td></tr>
						<tr><td><label>'.$this->report_name.' Date</label></td><td><label>Days Post Planting</label></td></tr>
						<tr><td class="content">'.$this->sample_date.'</td><td class="content">'.$this->days_post_planting.'</td></tr>
						<tr><td><label>Target Paddock Population</label></td><td><label>Target Paddock Yield</label></td></tr>
						<tr><td class="content">'.$this->paddock->paddock_target_population.'</td><td class="content">'.round($this->target_paddock_yield).' tonnes ['.round($this->target_paddock_tonnes_hectare).' t/ha]</td></tr>
					</table>
					<!-- end::farm & paddock details -->';
		$html .= '<!-- begin::assessment report summary --><br><br>'.self::getReportSummaryByAssessmentType().'<!-- end::assessment report summary -->';
		$html .= '<!-- begin::assessment report chart -->'.self::getReportChartURI().'<!-- end::assessment report chart -->';		
		
		$html .= '<!-- begin::data collection report -->'.self::getReportDataByAssessmentType().'<!-- end::data collection report --></div><!-- end::assessment report -->';
								
				
        return $html; 
    }
    */
	
	private function responsiveDefaultTextValues(){
		return ' class="responsive" data-min="5" data-max="14" ';
	}
	private function formatLongDate($date){
		// convert string to integer
		$time = strtotime($date);
		// return format e.g. 1 April 2017
		return date('j F Y', $time);
	}
 
    public function HTMLReport_footer(){
        $html = '';
        return $html;         
    }
	
	private function getReportSummaryByAssessmentType($screen){
		//print_r($this->report_name);
		switch ($this->report_name){
			case 'Emergence':
				$html = self::getHTMLEmergenceAssessment($screen);
				break;
			case 'Threeleaf':				
			case 'Fiveleaf':				
			case 'Bulbing':
				$html = self::getHTMLThreeFiveBulbingAssessment($screen);
				break;
			case 'Harvest':
				$html = self::getHTMLHarvestAssessment($screen);
				break;
			default:
				$html = '<div>ERROR: No data available for report</div>';
		}

		return $html;
	}
	
	/* // deprecated
	private function getReportChartURI(){
		$html = '
			<div class="tg-wrap_charts" style="page-break-before: always;">
			<h2 style="margin:20 0 0 0;text-transform: none;">Zone '.self::formatReportName($this->report_name).' Chart</h2>
			<table class="tg_charts">
			<!-- charts section -->
			<!-- 
			  <tr>
                <td class="tg_charts" colspan="1"><div><img style="width:100%;" src="'.Request::post('chartURI').'"></div></td>
              </tr>
            </table>
			</div';
		return $html;
	}
	*/
	
	private function getReportDataByAssessmentType(){
		//print_r($this->report_name);
		switch ($this->report_name){
			case 'Emergence':
				$html = self::getHTMLSampleDataEmergence();
				break;
			case 'Threeleaf':				
			case 'Fiveleaf':				
			case 'Bulbing':
				$html = self::getHTMLSampleDataThreeFiveBulbing();
				break;
			case 'Harvest':
				$html = self::getHTMLSampleDataHarvest();
				break;
			default:
				$html = '<div>ERROR: No data available for report</div>';
		}
		return $html;		
	}
	
	private function getHTMLSampleDataEmergence(){
		// display all collected samples for specific farm/paddock/crop @ emergence
		
		//$data = self::buildSampleDataTable( $this->crop->farm_id, $this->crop->paddock_id, $this->crop->crop_id, $this->growth_stage_id );
		$data = self::buildSampleDataTable( $this->crop->crop_id, $this->growth_stage_id );
		
		$html = '
		<h2 style="margin:20 0 0 0;text-transform: none;">Zone Sample Results</h2>				
			<table class="report-table responsive" data-min="5" data-max="12" style="background-color:#777; margin-bottom:15px; text-transform: none;">
				<thead>
					<tr style="background-color: #ddd; color: #111;">
						<th rowspan=2>Zone</th>
						<th rowspan=2>Plot#</th>
						<th rowspan=2>Sample<br>Date</th>
						<th colspan=2>Population</th>
						<th rowspan=2>Population<br>Limited</th>
					</tr>
					<tr style="background-color: #ddd; color: #111;">
						<th>(plants/plot)</th>
						<th>(plants/m<sup>2</sup>)</th>
					</tr>
				</thead>
				<tbody>';
				
		foreach ($data as $zone) {
			// intialise the variables
			$i = 1;
			$sum_sample_count_plot = 0;
			$sum_sample_count_sqm = 0;
			$sum_sample_ela_score = 0;
			$sum_sample_groundcover_cm_plant_sqm = 0;
			$sum_sample_lai_cm_plant_sqm = 0;
			$sum_sample_yield_tonnes_hectare = 0;
			foreach ($zone as $key=>$sample_data) {
				$html .= '<tr style="background-color: #fff; text-align:center;"><td>'.$sample_data->zone_name.'</td>
					<td>'.$key.'</td>
					<td>'.$sample_data->sample_date.'</td>
					<td>'.$sample_data->sample_count_plot.'</td>
					<td>'.round($sample_data->sample_count_sqm,2).'</td>
					<td>'.strtoupper($sample_data->sample_population_limited).'</td>
				</tr>';
				
				$sum_sample_count_plot += $sample_data->sample_count_plot;
				$sum_sample_count_sqm += $sample_data->sample_count_sqm;
				$i++;
			}

			// summed averages row
			$html .= '<tr style="background-color: #eee; color: #111; font-weight:bold;text-align: center;"><td style="text-align: right;" colspan="3">'.$sample_data->zone_name.' Zone Average</td>
					<td>'.round($sum_sample_count_plot/($i-1),0).'</td>
					<td>'.round($sum_sample_count_sqm/($i-1),2).'</td>
					<td>&nbsp;</td>						
				</tr>';
		}
		$html .= '</tbody></table>';
		
		//$html_comments = self::getZoneCommentsByGrowthStageID($this->crop->farm_id, $this->crop->paddock_id, $this->growth_stage_id);
		$html_comments = self::getZoneCommentsByGrowthStageID($this->crop->crop_id, $this->growth_stage_id);		
		
		return $html.$html_comments;
	}
	
	private function getHTMLSampleDataThreeFiveBulbing(){
		// display all collected samples for specific farm/paddock @ 3leaf,5leaf,bulbing		

		//$data = self::buildSampleDataTable($this->crop->farm_id, $this->crop->paddock_id, $this->growth_stage_id);
		$data = self::buildSampleDataTable($this->crop->crop_id, $this->growth_stage_id);		

		$html = '
		<h2 style="margin:20 0 0 0;text-transform: none;">Zone Sample Results</h2>					
			<table class="report-table responsive" data-min="5" data-max="13" style="background-color:#777; margin-bottom:15px; text-transform: none;">
				<thead>
					<tr style="background-color: #ddd; color: #111;">
						<th>Zone</th>
						<th>Plot#</th>
						<th>Sample<br>Date</th>
						<!--<th>Population<br>(plants/plot)</th>-->
						<th>Population<br>(plants/m<sup>2</sup>)</th>							
						<th>Canopy<br>Cover<br>(% plot)</th>
						<!--<th>Groundcover<br>(cm<sup>2</sup>/plant/m<sup>2</sup>)</th>-->
						<th>Estimated<br>Leaf Area<br>(cm<sup>2</sup>/plant/m<sup>2</sup>)</th>
						<th>Population<br>Limited</th>
						<th>Growth<br>Limited</th>
						<th>Estimated<br>Yield<br>(t/ha)</th>						
					</tr>
				</thead><tbody>';
		foreach ($data as $zone) {
			// initialise the variables
			$i = 1;
			$sum_sample_count_plot = 0;
			$sum_sample_count_sqm = 0;
			$sum_sample_ela_score = 0;
			$sum_sample_groundcover_cm_plant_sqm = 0;
			$sum_sample_lai_cm_plant_sqm = 0;
			$sum_population_limited = 0;
			$sum_growth_limited = 0; 
			$sum_sample_yield_tonnes_hectare = 0;
			foreach ($zone as $sample_data) {
				$html .= '<tr style="background-color: #fff;"><td>'.$sample_data->zone_name.'</td>
					<td>'.$i.'</td>
					<td>'.$sample_data->sample_date.'</td>
					<!--<td>'.$sample_data->sample_count_plot.'</td>-->
					<td>'.round($sample_data->sample_count_sqm,2).'</td>
					<td>'.$sample_data->sample_ela_score.'</td>
					<!--<td>'.round($sample_data->sample_groundcover_cm_plant_sqm,2).'</td>-->
					<td>'.round($sample_data->sample_lai_cm_plant_sqm,2).'</td>					
					<td>'.strtoupper($sample_data->sample_population_limited).'</td>
					<td>'.strtoupper($sample_data->sample_growth_limited).'</td>
					<td>'.round($sample_data->sample_yield_tonnes_hectare,2).'</td>
				</tr>';
				
				//$sum_sample_count_plot += $sample_data->sample_count_plot;
				$sum_sample_count_sqm += $sample_data->sample_count_sqm;
				$sum_sample_ela_score += $sample_data->sample_ela_score;
				//$sum_sample_groundcover_cm_plant_sqm += $sample_data->sample_groundcover_cm_plant_sqm;
				$sum_sample_lai_cm_plant_sqm += $sample_data->sample_lai_cm_plant_sqm;
				
				//$isLimited = ($sample_data->sample_population_limited == 'y') ? 1: 0;
				$sum_population_limited += ($sample_data->sample_population_limited == 'y') ? 1: 0;
				
				//$isLimited = ($sample_data->sample_growth_limited == 'y') ? 1: 0;
				$sum_growth_limited += ($sample_data->sample_growth_limited == 'y') ? 1: 0;

				$sum_sample_yield_tonnes_hectare += $sample_data->sample_yield_tonnes_hectare;
				$i++;
			}
			//echo print_r($sum_population_limited.',',true);
			// summed averages row
			$html .= '<tr style="background-color: #eee; color: #111; font-weight:bold;text-align: center;"><td style="text-align: right;" colspan="3">'.$sample_data->zone_name.' Zone Average</td>
					<!--<td>'.round($sum_sample_count_plot/($i-1),2).'</td>-->
					<td>'.round($sum_sample_count_sqm/($i-1),2).'</td>
					<td>'.round($sum_sample_ela_score/($i-1),2).'</td>
					<!--<td>'.round($sum_sample_groundcover_cm_plant_sqm/($i-1),2).'</td>-->
					<td>'.round($sum_sample_lai_cm_plant_sqm/($i-1),2).'</td>
					<td>'.strtoupper($sum_population_limited < (($i-1)/2) ? 'n': 'y').'</td>
					<td>'.strtoupper($sum_growth_limited < (($i-1)/2) ? 'n': 'y').'</td>
					<td>'.round($sum_sample_yield_tonnes_hectare/($i-1),2).'</td>					
				</tr>';
		}
		$html .= '</tbody></table>';
		
		$html_comments = self::getZoneCommentsByGrowthStageID($this->crop->farm_id, $this->crop->paddock_id, $this->growth_stage_id);

		return $html.$html_comments;
	}
	
	private function getHTMLSampleDataHarvest(){
		
		// display all collected samples for specific farm/paddock @ harvest
		//$data = self::buildSampleDataTable($this->crop->farm_id, $this->crop->paddock_id, $this->growth_stage_id);
		$data = self::buildSampleDataTable($this->crop->crop_id, $this->growth_stage_id);		
		/*
		echo '<pre>';
		echo var_dump($data);
		echo '</pre>';
		*/		
		$html = '<h2 style="margin:20 0 0 0;text-transform: none;">Zone Sample Results</h2>
			<table class="report-table responsive" data-min="6" data-max="12" style="background-color:#777; margin-bottom:15px; text-transform: none;">
				<thead>
					<tr style="background-color: #ddd; color: #111;">
						<th rowspan=2>Zone</th>
						<th rowspan=2>Plot#</th>
						<th rowspan=2>Date</th>
						<th colspan=2>Population</th>							
						<th colspan=2>Weight</th>
						<th rowspan=2>Estimated Yield <br>(t/ha)</th>						
					</tr>
					<tr style="background-color: #ddd; color: #111;">
						<th>(bulbs/plot)</th>
						<th>(bulbs/m<sup>2</sup>)</th>
						<th>(kgs/plot)</th>
						<th>(kgs/m<sup>2</sup>)</th>
					</tr>
				</thead><tbody>';				
		foreach ($data as $zone) {
			// initialise
			$sum_sample_count_plot = 0;
			$sum_sample_count_sqm = 0;
			$sum_sample_weight_plot = 0;
			$sum_sample_weight_sqm = 0;
			$sum_sample_yield_tonnes_hectare = 0;			
			$i = 1;
			foreach ($zone as $sample_data) {
				$html .= '<tr style="background-color: #fff;"><td style="text-align: center">'.$sample_data->zone_name.'</td>
					<td style="text-align: center">'.$i.'</td>
					<td style="text-align: center">'.$sample_data->sample_date.'</td>
					<td style="text-align: center">'.$sample_data->sample_count_plot.'</td>
					<td style="text-align: center">'.round($sample_data->sample_count_sqm,2).'</td>
					<td style="text-align: center">'.round($sample_data->sample_weight_kg_plot,2).'</td>
					<td style="text-align: center">'.round($sample_data->sample_weight_kg_sqm,2).'</td>
					<td style="text-align: center">'.round($sample_data->sample_yield_tonnes_hectare,2).'</td>
				</tr>';
				$sum_sample_count_plot += $sample_data->sample_count_plot;
				$sum_sample_count_sqm += $sample_data->sample_count_sqm;
				$sum_sample_weight_plot += $sample_data->sample_weight_kg_plot;
				$sum_sample_weight_sqm += $sample_data->sample_weight_kg_sqm;
				$sum_sample_yield_tonnes_hectare += $sample_data->sample_yield_tonnes_hectare;
				$i++;
			}
			// summed averages row
			$html .= '<tr style="background-color: #eee; color: #111; font-weight:bold;text-align: center;"><td style="text-align: right;" colspan="3">'.$sample_data->zone_name.' Zone Average</td>
					<td>'.round($sum_sample_count_plot/($i-1),0).'</td>
					<td>'.round($sum_sample_count_sqm/($i-1),2).'</td>
					<td>'.round($sum_sample_weight_plot/($i-1),2).'</td>
					<td>'.round($sum_sample_weight_sqm/($i-1),2).'</td>
					<td>'.round($sum_sample_yield_tonnes_hectare/($i-1),2).'</td>					
				</tr>';
		}
		$html .= '</tbody></table>';		
		$html_comments = self::getZoneCommentsByGrowthStageID($this->crop->farm_id, $this->crop->paddock_id, $this->growth_stage_id);
		return $html.$html_comments;		
	}
	
	//private function getZoneCommentsByGrowthStageID($farm_id, $paddock_id, $growth_stage_id) {
	private function getZoneCommentsByGrowthStageID($crop_id, $growth_stage_id) {		
        
		/* At the specific growth stage get all samples for each zone; */
		$database = DatabaseFactory::getFactory()->getConnection();
		$sql = "SELECT z.zone_name, s.zone_sample_plot_id, s.sample_comment
				FROM zone z, sample s
				WHERE				
				s.growth_stage_id = :growth_stage_id AND
				s.zone_id = z.zone_id AND
				s.crop_id = :crop_id				
				ORDER BY 
				s.zone_sample_plot_id";	

        $query = $database->prepare($sql);
        $query->execute(array(':growth_stage_id' => $growth_stage_id,
							':crop_id' => $crop_id));
		$zone_comments = array();
        foreach ($query->fetchAll() as $comment) {	
			//echo print_r($data->zone_id, true);
			if ( strlen($comment->sample_comment) > 0 ) {
				$zone_comments[$comment->zone_name][$comment->zone_sample_plot_id] = new stdClass();
				$zone_comments[$comment->zone_name][$comment->zone_sample_plot_id]->zone_name = $comment->zone_name;	
				$zone_comments[$comment->zone_name][$comment->zone_sample_plot_id]->sample_comment = $comment->sample_comment;			
			}
		}

		$html_comments = '';

		if (count($zone_comments) != 0) {			
			$html_comments = '
			<h2 style="margin:20 0 0 0;text-transform: none;">Zone Sample Comments</h2>					
			<table class="report-table">
				<thead>
					<tr><th>Zone</th><th>Plot#</th><th style="text-align:left;">Comments</th></tr>
				</thead><tbody>';			
			foreach ($zone_comments as $zone){
				foreach ($zone as $key=>$comment){
					$html_comments .= '<tr><td>'.$comment->zone_name.'</td><td>'.$key.'</td><td class="col-last">'.$comment->sample_comment.'</td></tr>';	
				}
			}	
			$html_comments .= '</tbody></table></div>';			
		}	
		return $html_comments;
	}

	// To-do - move to separate ZoneSampleData class
	//private function buildSampleDataTable($farm_id, $paddock_id, $crop_id, $growth_stage_id, $saveCSV = false){
	private function buildSampleDataTable($crop_id, $growth_stage_id, $saveCSV = false){		

		/* At the specific growth stage get all samples for each zone; */
		$database = DatabaseFactory::getFactory()->getConnection();

		$sql = "SELECT z.zone_name, z.zone_id, s.zone_sample_plot_id, s.sample_date, s.sample_count,
			s.sample_comment, s.sample_ela_score, s.sample_bulb_weight
			FROM zone z, sample s
			WHERE				
			s.growth_stage_id = :growth_stage_id AND
			s.zone_id = z.zone_id AND
			s.crop_id = :crop_id			
			ORDER BY 
			z.zone_id, s.zone_sample_plot_id";	

        $query = $database->prepare($sql);
        $query->execute(array(':growth_stage_id' => $growth_stage_id,
							':crop_id' => $crop_id));

		//$plot_width = Config::get('SAMPLE_PLOT_WIDTH');
		$plot_width = $this->crop->crop_sample_plot_width;
		$crop_bed_width = $this->crop->crop_bed_width;
		$planting_date = $this->crop->crop_plant_date;


		// data table
		$zone_data = array();
		
        foreach ($query->fetchAll() as $data) {	
			$zone_data[$data->zone_name][$data->zone_sample_plot_id] = new stdClass();
			$zone_data[$data->zone_name][$data->zone_sample_plot_id]->zone_name = $data->zone_name;	
			$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_date = $data->sample_date;
			$sample_count_plot = $data->sample_count;
			$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_count_plot = $sample_count_plot;			
			$samples_sqm = ReportsModel::unitPerSquareMeter($sample_count_plot, $crop_bed_width, $plot_width);				
			$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_count_sqm = $samples_sqm;
			if ( $growth_stage_id == 1 ) {
				$populationLimited = ReportsModel::populationLimited($this->crop->crop_plant_spacing, $this->crop->crop_bed_rows, 
								$this->crop->crop_bed_width, $this->crop->crop_sample_plot_width, $data->sample_count);
				//$isLimited = ($populationLimited) ? 'y': 'n';				
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_population_limited = ($populationLimited) ? 'y': 'n';
			}	
			if ( $growth_stage_id == 2 || $growth_stage_id == 3 || $growth_stage_id == 4 ){ // 3,5,bulbing				
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_ela_score = $data->sample_ela_score;				
				$gc_cm_plant_sqm = (10000*($data->sample_ela_score/100))/$samples_sqm;
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_groundcover_cm_plant_sqm = $gc_cm_plant_sqm;
				$zone_mean_leaf_area_cm_plant_sqm = $this->GroundCoverCMToLAI($gc_cm_plant_sqm);
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_lai_cm_plant_sqm = $zone_mean_leaf_area_cm_plant_sqm;				
				$populationLimited = ReportsModel::populationLimited($this->crop->crop_plant_spacing, $this->crop->crop_bed_rows, 
					$this->crop->crop_bed_width, $this->crop->crop_sample_plot_width, $data->sample_count);
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_population_limited = ($populationLimited) ? 'y': 'n';
				$growthLimited = ReportsModel::isGrowthLimited( $growth_stage_id, $zone_mean_leaf_area_cm_plant_sqm );
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_growth_limited = ($growthLimited) ? 'y': 'n';
				if ($growth_stage_id != 4) {
					// leaves are counted at 3-5 leaf stage not bulbing						
					$zone_mean_leaf_number = ReportsModel::zoneGrowthStageMeanLeafNumber($growth_stage_id, $data->zone_id);				
				} else {
					$zone_mean_leaf_number = null;
				}
				$estimated_yield_tonnes_hectare = ReportsModel::zoneTargetYield($zone_mean_leaf_area_cm_plant_sqm, $zone_mean_leaf_number, $samples_sqm, $planting_date);
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_yield_tonnes_hectare = $estimated_yield_tonnes_hectare;
			}
			if ( $growth_stage_id == 5 ){ // harvest 
				// add weight data
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_weight_kg_plot = $data->sample_bulb_weight;
				//$sample_weight_kg_sqm = (1/($paddock_bed_width*$plot_width))*$data->sample_bulb_weight;
				$sample_weight_kg_sqm = ReportsModel::unitPerSquareMeter($data->sample_bulb_weight, $crop_bed_width, $plot_width);
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_weight_kg_sqm = $sample_weight_kg_sqm;				
				$sample_yield_tonnes_hectare = number_format($sample_weight_kg_sqm*10, 2, '.', ''); // harvest stage
				$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_yield_tonnes_hectare = $sample_yield_tonnes_hectare;
					//self::setZoneYieldEstimateByGrowthStage($farm_id, $paddock_id, $result->zone_id, $growth_stage_id, $zone_harvest_yield);
			}
			$zone_data[$data->zone_name][$data->zone_sample_plot_id]->sample_comment = $data->sample_comment;	
			//if ($saveCSV === true) {
				// add each row of data to the csv
				//fputcsv($output, $zone_data);				
			//}
		}	
		return $zone_data;
	}

	// To-do - move to separate ZoneSampleData class
	private function GroundCoverCMToLAI($gc_cm_plant_sqm){
		
		(float)$base = 0.183;		
		(float)$exp = 0.0498;	
		$leaf_area = pow($base,$exp) * (float)$gc_cm_plant_sqm;	
		
		return $leaf_area;	
	}

	private function getHTMLEmergenceAssessment($screen){
		
		
		$report = ReportsModel::buildAssessmentReport($this->crop->farm_id, $this->crop->paddock_id, $this->crop->crop_id, $this->growth_stage_id);
		
		$sum_area = 0;
		$sum_target_population = 0;
		$sum_estimate_population = 0;
		
		$html = '<div>
			<p><h2 style="margin:20px 0 5px 0;text-transform: none;">Zone Summary</h2></p>
			<table class="report-table responsive" data-min="8" data-max="13" data-width="100%" style="background-color:#777; padding:0;text-transform: none;">
			<thead>
				<tr style="background-color: #ddd; color: #111;">
					<th rowspan=2>Zone</th>
					<th rowspan=2>Zone Area<br>(hectares)</th>
					<th colspan=2>Target<br/>Population</th>
					<th colspan=2>Estimated<br>Population</th>
					<th rowspan=2>Difference</th>
					<th rowspan=2>Population<br>Limited</th>
				</tr>
				<tr style="background-color: #ddd; color: #111;">
					<th>plants/zone</th>
					<th>plants/m<sup>2</sup></th>
					<th>plants/zone</th>
					<th>plants/m<sup>2</sup></th>

				</tr>						
			</thead>
			<tbody>';
						
			foreach ($report as $report_row) {
				$html .= '<tr style="background-color: #fff;">
					<td style="text-align: center">'.$report_row->zone_name.'</td>
					<td style="text-align: center">'.$report_row->zone_area.'</td>
					<td style="text-align: center">'.round($report_row->zone_target_population).'</td>
					<td style="text-align: center">'.round(($report_row->zone_target_population/10000)/$report_row->zone_area).'</td>								
					<td style="text-align: center">'.round($report_row->zone_population_estimate).'</td>
					<td style="text-align: center">'.round(($report_row->zone_population_estimate/10000)/$report_row->zone_area).'</td>
					<td style="text-align: center">'.$report_row->zone_difference.'%</td>								
					<td style="text-align: center">'.strtoupper($report_row->zone_population_limited).'</td>
				</tr>';
				$sum_area += (float)$report_row->zone_area;
				$sum_target_population += (int)$report_row->zone_target_population;
				$sum_estimate_population += (int)$report_row->zone_population_estimate;
			}
			// determine if population limited or not			
			$cropZoneDifference = ReportsModel::zonePopulationDifference($sum_target_population, $sum_estimate_population);
			$population_limited_threshold = (float)Config::get('POPULATION_LIMITED_PERCENT')*100; // stored as a decimal fraction e.g. 0.15			
			$isPopulationLimited = abs($cropZoneDifference) > $population_limited_threshold ? 'y': 'n';			
			
			$html .= '</tbody><tfoot><tr style="background-color: #eee; color: #111;">
					<td>&nbsp;</td>
					<td style="padding:0.5em;text-align: center; font-weight: bold">'.$sum_area.' ha</td>
					<td style="padding:0.5em;text-align: center; font-weight: bold">'.$sum_target_population.'</td>
					<td style="padding:0.5em;text-align: center; font-weight: bold">'.round(($sum_target_population/10000)/$sum_area).'</td>
					<td style="padding:0.5em;text-align: center; font-weight: bold">'.$sum_estimate_population.'</td>
					<td style="padding:0.5em;text-align: center; font-weight: bold">'.round(($sum_estimate_population/10000)/$sum_area).'</td>
					<td style="padding:0.5em;text-align: center; font-weight: bold">'.$cropZoneDifference.'%</td>
					<td>&nbsp;</td>';			
			$html .= '</td>				
					</tr></tfoot>
				</table>';
			
		return $html;			
	}
	
	private function getHTMLThreeFiveBulbingAssessment(){

		$report = ReportsModel::buildAssessmentReport($this->crop->farm_id, $this->crop->paddock_id, $this->crop->crop_id, $this->growth_stage_id);
		
		$html = '<div>
				<p><h2 style="margin:20 0 0 0;text-transform: none;">Zone Summary</h2></p>
				<table class="report-table responsive" data-min="5" data-max="13" style="background-color:#777; margin-bottom:10px;text-transform: none;">
					<thead style="height:100%">
						<tr style="background-color: #ddd; color: #111;">
							<th rowspan="2">Zone</th>';
					if ($this->growth_stage_id != 4){
						$html .= '<th colspan="4">Canopy Assessments</th>';
					} else {
						$html .= '<th colspan="3">Canopy Assessments</th>';
					}		
					$html .= '<th colspan="4">Yield Assessments</th>								
						</tr>
						<tr style="background-color: #ddd; color: #111;">							
							<th>Average<br>Population<br>(plants/m<sup>2</sup>)</th>
							<th>Average<br>Canopy Cover<br>(%)</th>';
					if ($this->growth_stage_id != 4){
						$html .= '<th>Average<br>Leaf<br>Number</th>';
					}		
					$html .= '<th>Average<br>Leaf Area<br>(cm<sup>2</sup>/plant/m<sup>2)</th>
							<th>Estimated<br>Yield<br>(t/ha)</th>
							<th>Population<br>Limited</th>
							<th>Growth<br>Limited</th>
							<th>Management<br>Action Zone</th>							
						</tr>
					</thead>
					<tbody>';
					foreach ($report as $report_row) {
						$html .= '<tr style="background-color: #fff;">
									<td style="text-align: center">'.$report_row->zone_name.'</td>
									<td style="text-align: center">'.round($report_row->sample_plant_average, 2).'</td>
									<td style="text-align: center">'.round($report_row->ground_cover_average, 2).'</td>';
						if ($this->growth_stage_id != 4){
							$html .= '<td style="text-align: center">'.round($report_row->zone_mean_leaf_number, 2).'</td>';
						}
									
						$html .= '<td style="text-align: center">'.round($report_row->lai_estimate_cm_plant_sqm, 2).'</td>
									<td style="text-align: center">'.round($report_row->zone_target_yield, 2).'</td>
									<td style="text-align: center">'.strtoupper($report_row->zone_population_limited_yield).'</td>
									<td style="text-align: center">'.strtoupper($report_row->zone_growth_limited_yield).'</td>';
						// add management action zone information
						switch ($report_row->management_action_zone){
							case 1: // Population Expected; Yield Expected - Do Nothing
								$html .= '<td style="text-align: center; background-color: #80cc33; color: #000; font-weight: bold">'.$report_row->management_action_zone.'</td>';
								break;
							case 2: // Population Expected; Yield Low - Revise Management 
								$html .= '<td style="text-align: center; background-color: #ffcc33; color: #000; font-weight: bold">'.$report_row->management_action_zone.'</td>';									
								break;
							case 3: // Population Low; Yield Expected - Increase Population 
								$html .= '<td style="text-align: center; background-color: #3380cc; color: #000; font-weight: bold">'.$report_row->management_action_zone.'</td>';
								break;
							case 4: // Population Low; Yield Low - Increase Population & Revise Management
								$html .= '<td style="text-align: center; background-color: #ff3333; color: #000; font-weight: bold">'.$report_row->management_action_zone.'</td>';
								break;								
							default:
							// To-do - trap error
						}
						$html .= '</tr></tbody>';
					}
		$html .= '<tfoot><tr style="background-color: #eee; color: #111;">';
		if ($this->growth_stage_id != 4){
			$html .= '<td colspan="5" style="text-align: right; font-weight: bold; padding:0.5em;">Area Weighted Estimate: Total Crop Yield (tonnes)</td>
					<td colspan="4" style="text-align: center; font-weight: bold; padding:0.5em;">';
		}else{
			$html .= '<td colspan="4" style="text-align: right; font-weight: bold; padding:0.5em;">Area Weighted Estimate: Total Crop Yield (tonnes)</td>
					<td colspan="4" style="text-align: center; font-weight: bold; padding:0.5em;">';
		}

		switch ($this->growth_stage_id){
			case 2:				
				$html .= $report_row->weighted_sum_three_leaf_yield.' '.$report_row->three_leaf_tonnes_hectare;
				break;
			case 3:
				$html .= $report_row->weighted_sum_five_leaf_yield.' '.$report_row->five_leaf_tonnes_hectare;
				break;
			case 4:
				$html .= $report_row->weighted_sum_bulbing_yield.' '.$report_row->bulbing_tonnes_hectare;
				break;				
			default:
			// To-do - trap error
		}
		$html .= '</td>				
			</tr></tfoot>
		</table></div>
		<div id="maz_table" name="maz_table">
			<img class="imgfit" src="'.Config::get('URL').'images/maz.png"/>
		</div>';
		return $html;		
	}
	
	
	private function getHTMLHarvestAssessment(){
		
		$report = ReportsModel::buildAssessmentReport($this->crop->farm_id, $this->crop->paddock_id, $this->crop->crop_id, $this->growth_stage_id);
		$html = '<div>
				<h2 style="margin:20 0 0 0;text-transform: none;">Zone Summary</h2>
			<!--<table class="report-table">-->
			<table class="responsive" data-min="5" data-max="13" style="background-color:#777; margin-bottom:15px; text-transform: none;">
						<thead>
							<tr style="background-color: #ddd; color: #111;">
								<th rowspan="2">Zone</th>
								<th colspan="2">Crop Assessments</th>
								<th colspan="4">Fresh Mass Yield Assessments</th>
							</tr>
							<tr style="background-color: #ddd; color: #111;">							
								<th>Average<br>Population</br>(bulbs/m<sup>2</sup>)</th>
								<th>Average<br>Weight</br>(kgs/m<sup>2</sup>)</th>								
								<th>Three Leaf</br>(t/ha)</th>
								<th>Five Leaf</br>(t/ha)</th>
								<th>Bulbing</br>(t/ha)</th>
								<th>Harvest</br>(t/ha)</th>							
							</tr>
						</thead>
						<tbody>';
						foreach ($report as $report_row) {
		$html .=			'<tr style="background-color: #fff;text-align: center; ">
								<td>'.$report_row->zone_name.'</td>
								<td>'.round($report_row->sample_plant_average, 2).'</td>
								<td style="text-transform:lowercase;">'.round($report_row->sample_average_weight, 2).'</td>
								<td>'.$report_row->zone_three_leaf_yield.'</td>
								<td>'.$report_row->zone_five_leaf_yield.'</td>
								<td>'.$report_row->zone_bulbing_yield.'</td>
								<td>'.$report_row->zone_harvest_yield.'</td>
							</tr>';
						}
		$html .=  		'</tbody>
						<tfoot>';
						{
		$html .=  			'<tr style="background-color: #eee; color: #111;">
								<td colspan="3" style="text-align: right; font-weight: bold; padding:0.5em;">Area Weighted Estimate: Total Crop Yield (tonnes)</td>								
								<td style="text-align: center; font-weight: bold; padding:0.5em;">'.$report_row->weighted_sum_three_leaf_yield.'<br>'.$report_row->three_leaf_tonnes_hectare.'</td>
								<td style="text-align: center; font-weight: bold; padding:0.5em;">'.$report_row->weighted_sum_five_leaf_yield.'<br>'.$report_row->five_leaf_tonnes_hectare.'</td>
								<td style="text-align: center; font-weight: bold; padding:0.5em;">'.$report_row->weighted_sum_bulbing_yield.'<br>'.$report_row->bulbing_tonnes_hectare.'</td>
								<td style="text-align: center; font-weight: bold; padding:0.5em;">'.$report_row->weighted_sum_harvest_yield.'<br>'.$report_row->harvest_tonnes_hectare.'</td>
							</tr>';
						} 
		$html .=  '</tfoot>							
				</table>';
		return $html;			
	}
}        
